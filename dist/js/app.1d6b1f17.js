(function(){"use strict";var e={891:function(e,t,r){var s=r(8935),n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("h1",[e._v("iPOND WebRTC Studio")]),r("h3",[e._v("Using Janus webRTC server.")]),r("div",{staticClass:"select-ctn"},[r("select",{directives:[{name:"model",rawName:"v-model",value:e.streamList.selected,expression:"streamList.selected"}],attrs:{disabled:e.stream},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.streamList,"selected",t.target.multiple?r:r[0])}}},e._l(e.streamList.options,(function(t){return r("option",{key:t.id,domProps:{value:t.id}},[e._v(" "+e._s(t.description)+" ")])})),0),r("div",[e._v(e._s(null==e.stream?"null":e.notNull))]),r("button",{attrs:{disabled:e.stream},on:{click:function(t){return t.preventDefault(),e.start.apply(null,arguments)}}},[e._v("Start")]),r("button",{attrs:{disabled:!e.stream},on:{click:function(t){return t.preventDefault(),e.stop.apply(null,arguments)}}},[e._v("Stop")])]),"starting"==e.status?r("h3",[e._v(" Loading video stream ... ")]):e._e(),r("div",{staticClass:"video-vtn"},[r("video",{ref:"videoStream",attrs:{autoplay:"autoplay",playsinline:"",width:"640px",height:"480px"},domProps:{srcObject:e.stream}})]),e.stream?e._e():r("div",[e._v("No Stream")]),r("div",[e._v("Status: "+e._s(e.status?e.status:"No video stream"))]),e.error?r("div",[e._v(e._s(e.error))]):e._e()])},o=[],i=r(2970);const a="https://34.143.225.243:8089/janus";var u={name:"App",data(){return{janus:null,error:null,plugin:null,status:null,stream:null,streamList:{selected:null,options:[]},remoteTracks:{},remoteVideos:0}},mounted(){i.c.init({debug:!0,dependencies:i.c.useDefaultDependencies(),callback:()=>{console.log("Connecting to Janus api with server ",a),this.connect(a)}})},methods:{connect(e){this.janus=new i.c({server:e,success:()=>{console.log("Connected"),this.attachPlugin()},error:e=>{console.log("Error"),this.onError("Failed to connect janus server",e)},destroyed:()=>{console.log("Destroyed"),window.location.reload()}})},attachPlugin(){this.janus.attach({plugin:"janus.plugin.streaming",opaqueId:"thisisopaqueid",success:e=>{this.plugin=e,console.log("getBitrate : ",this.plugin.getBitrate()),this.updateStreamsList()},error:e=>{this.onError("Error attaching plugin... ",e)},iceState:e=>{console.log("ICE state changed to ",e)},webrtcState:e=>{console.log("Janus says our WebRTC PeerConnection is "+(e?"up":"down")+" now")},slowLink:(e,t,r)=>{console.log("Janus reports problems "+(e?"sending":"receiving")+" packets on mid "+r+" ("+t+" lost packets)")},onmessage:(e,t)=>{console.log(" ::: Got a message :::",e);let r=e.result;if(r)r.status&&(this.status=r.status);else if(e.error)return this.onError(e.error),void this.stop();if(t){i.c.debug("Handling SDP as Well... ",t);let e=-1!==t.sdp.indexOf("stereo=1");this.plugin.createAnswer({jsep:t,media:{audioSend:!1,videoSend:!1,data:!0},customizeSdp:t=>{e&&-1==t.sdp.indexOf("stereo=1")&&(t.sdp=t.sdp.replace("useinbandfec=1","useinbandfec=1;stereo=1"))},success:e=>{i.c.debug("Got SDP!",e);let t={request:"start"};this.plugin.send({message:t,jsep:e})},error:e=>{this.onError("WebRTC Error: ",e),alert("WebRTC error... ",e)}})}},onremotetrack:(e,t,r)=>{i.c.debug("Remote track (mid="+t+") "+(r?"added":"removed")+":",e),"video"===e.kind&&(this.remoteVideos++,this.stream=new MediaStream,this.stream.addTrack(e.clone()),this.remoteTracks.mid=this.stream,i.c.log("Created remote audio stream:",this.stream))},oncleanup:()=>{this.onCleanup()}})},updateStreamsList(){this.plugin.send({message:{request:"list"},success:e=>{e||this.onError("Got no response to our query for available streams."),console.log("Updating StreamList....",e),this.streamList.options=e.list,e.list.length&&(this.streamList.selected=this.streamList.options[0].id)}})},start(){this.plugin.send({message:{request:"watch",id:this.streamList.selected}})},stop(){this.plugin.send({message:{request:"stop"}}),this.plugin.hangup()},onCleanup(){i.c.log(" ::: Got a cleanup notification :::"),this.stream=null,this.status=null,this.remoteTracks={},this.remoteVideos=0,this.error=null},onError(e,t=""){i.c.error(e,t),this.error=e+t,alert(this.error,(function(){window.location.reload()}))}}},l=u,c=r(1001),d=(0,c.Z)(l,n,o,!1,null,null,null),p=d.exports;s.Z.config.productionTip=!1,new s.Z({render:e=>e(p)}).$mount("#app")}},t={};function r(s){var n=t[s];if(void 0!==n)return n.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,r),o.exports}r.m=e,function(){var e=[];r.O=function(t,s,n,o){if(!s){var i=1/0;for(c=0;c<e.length;c++){s=e[c][0],n=e[c][1],o=e[c][2];for(var a=!0,u=0;u<s.length;u++)(!1&o||i>=o)&&Object.keys(r.O).every((function(e){return r.O[e](s[u])}))?s.splice(u--,1):(a=!1,o<i&&(i=o));if(a){e.splice(c--,1);var l=n();void 0!==l&&(t=l)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[s,n,o]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};r.O.j=function(t){return 0===e[t]};var t=function(t,s){var n,o,i=s[0],a=s[1],u=s[2],l=0;if(i.some((function(t){return 0!==e[t]}))){for(n in a)r.o(a,n)&&(r.m[n]=a[n]);if(u)var c=u(r)}for(t&&t(s);l<i.length;l++)o=i[l],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(c)},s=self["webpackChunkvue_janus"]=self["webpackChunkvue_janus"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=r.O(void 0,[998],(function(){return r(891)}));s=r.O(s)})();
//# sourceMappingURL=app.1d6b1f17.js.map