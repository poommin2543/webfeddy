(self["webpackChunkcontrol_robot"]=self["webpackChunkcontrol_robot"]||[]).push([[443],{7274:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return E}});var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("Streaming")],1)},i=[],o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("div",{staticClass:"select-ctn"},[r("select",{directives:[{name:"model",rawName:"v-model",value:e.streamList.selected,expression:"streamList.selected"}],attrs:{disabled:e.stream},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.streamList,"selected",t.target.multiple?r:r[0])}}},e._l(e.streamList.options,(function(t){return r("option",{key:t.id,domProps:{value:t.id}},[e._v(" "+e._s(t.description)+" ")])})),0),r("div",[e._v(e._s(null==e.stream?"null":e.notNull))]),r("button",{staticClass:"btn btn-primary",attrs:{type:"button",disabled:e.stream},on:{click:function(t){return t.preventDefault(),e.start.apply(null,arguments)}}},[e._v("Start")]),r("button",{staticClass:"btn btn-secondary",attrs:{type:"button",disabled:!e.stream},on:{click:function(t){return t.preventDefault(),e.stop.apply(null,arguments)}}},[e._v("Stop")])]),r("div",{staticClass:"md-layout"},[r("div",{staticClass:"md-layout-item"},["starting"==e.status?r("h3",[e._v(" Loading video stream ... ")]):e._e(),r("div",{staticClass:"video-vtn"},[r("video",{ref:"videoStream",attrs:{autoplay:"autoplay",playsinline:"",width:"640px",height:"480px"},domProps:{srcObject:e.stream}})])]),r("div",{staticClass:"md-layout-item"},[r("div",{staticClass:"map-section"},[r("gmap-map",{staticStyle:{width:"80%",height:"50%"},attrs:{center:e.center,zoom:15,options:{zoomControl:!1,scaleControl:!1,mapTypeControl:!1,fullscreenControl:!0,streetViewControl:!1,disableDefaultUi:!1}}},e._l(e.coordinates,(function(t,n){return r("gmap-marker",{key:n,attrs:{position:e.getPosition(t),clickable:!0,icon:e.getMarkers1(n)},on:{click:function(r){return e.toggleInfo(t,n)}}})})),1)],1)])]),r("div",{staticClass:"md-layout"},[r("div",{staticClass:"md-layout-item"},[e.stream?e._e():r("div",[e._v("No Stream")]),r("div",[e._v("Status: "+e._s(e.status?e.status:"No video stream"))]),e.error?r("div",[e._v(e._s(e.error))]):e._e()]),r("div",{staticClass:"md-layout-item"}),r("div",{staticClass:"md-layout-item"})])])},a=[],s=r(5200),c=(r(1539),r(9714),r(9720),r(2222),r(4916),r(5306),r(2032)),d=r(9726),u=(r(4723),r(1703),r(8309),r(8862),r(8783),r(3948),r(285),r(1637),r(9826),r(4747),r(3123),r(561),r(9600),r(7852),r(7435)["default"]);p.sessions={},p.isExtensionEnabled=function(){if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return!0;if(window.navigator.userAgent.match("Chrome")){var e=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),t=33;return window.navigator.userAgent.match("Linux")&&(t=35),e>=26&&e<=t||p.extension.isInstalled()}return!0};var l={extensionId:"hapfgfdkleiggjjpfpenajgdnfckjpaj",isInstalled:function(){return null!==document.querySelector("#janus-extension-installed")},getScreen:function(e){var t=window.setTimeout((function(){var t=new Error("NavigatorUserMediaError");return t.name='The required Chrome extension is not installed: click <a href="#">here</a> to install it. (NOTE: this will need you to refresh the page)',e(t)}),1e3);this.cache[t]=e,window.postMessage({type:"janusGetScreen",id:t},"*")},init:function(){var e={};this.cache=e,window.addEventListener("message",(function(t){if(t.origin==window.location.origin)if("janusGotScreen"==t.data.type&&e[t.data.id]){var r=e[t.data.id];if(delete e[t.data.id],""===t.data.sourceId){var n=new Error("NavigatorUserMediaError");n.name="You cancelled the request for permission, giving up...",r(n)}else r(null,t.data.sourceId)}else"janusGetScreenPending"==t.data.type&&(console.log("clearing ",t.data.id),window.clearTimeout(t.data.id))}))}};function p(e){if(e=e||{},e.success="function"==typeof e.success?e.success:p.noop,e.error="function"==typeof e.error?e.error:p.noop,e.destroyed="function"==typeof e.destroyed?e.destroyed:p.noop,!p.initDone)return e.error("Library not initialized"),{};if(!p.isWebrtcSupported())return e.error("WebRTC not supported by this browser"),{};if(p.log("Library initialized: "+p.initDone),!e.server)return e.error("Invalid server url"),{};var t=!1,r=null,n={},i=null,o=null,a=0,s=e.server;p.isArray(s)?(p.log("Multiple servers provided ("+s.length+"), will use the first that works"),s=null,o=e.server,p.debug(o)):0===s.indexOf("ws")?(t=!0,p.log("Using WebSockets to contact Janus: "+s)):(t=!1,p.log("Using REST API to contact Janus: "+s));var u=e.iceServers||[{urls:"stun:stun.l.google.com:19302"}],l=e.iceTransportPolicy,f=e.bundlePolicy,v=!0===e.ipv6,h=!1;void 0!==e.withCredentials&&null!==e.withCredentials&&(h=!0===e.withCredentials);var m=10;void 0!==e.max_poll_events&&null!==e.max_poll_events&&(m=e.max_poll_events),m<1&&(m=1);var g=null;void 0!==e.token&&null!==e.token&&(g=e.token);var y=null;void 0!==e.apisecret&&null!==e.apisecret&&(y=e.apisecret),this.destroyOnUnload=!0,void 0!==e.destroyOnUnload&&null!==e.destroyOnUnload&&(this.destroyOnUnload=!0===e.destroyOnUnload);var b=25e3;void 0!==e.keepAlivePeriod&&null!==e.keepAlivePeriod&&(b=e.keepAlivePeriod),isNaN(b)&&(b=25e3);var S=6e4;function C(e){var t={high:9e5,medium:3e5,low:1e5};return void 0!==e&&null!==e&&(e.high&&(t.high=e.high),e.medium&&(t.medium=e.medium),e.low&&(t.low=e.low)),t}void 0!==e.longPollTimeout&&null!==e.longPollTimeout&&(S=e.longPollTimeout),isNaN(S)&&(S=6e4);var w=!1,k=null,T={},R=this,P=0,D={};function A(){if(null!=k)if(p.debug("Long poll..."),w){var t=s+"/"+k+"?rid="+(new Date).getTime();m&&(t=t+"&maxev="+m),g&&(t=t+"&token="+encodeURIComponent(g)),y&&(t=t+"&apisecret="+encodeURIComponent(y)),p.httpAPICall(t,{verb:"GET",withCredentials:h,success:E,timeout:S,error:function(t,r){if(p.error(t+":",r),P++,P>3)return w=!1,void e.error("Lost connection to the server (is it down?)");A()}})}else p.warn("Is the server down? (connected=false)")}function E(e,n){if(P=0,t||void 0===k||null===k||!0===n||A(),t||!p.isArray(e))if("keepalive"!==e["janus"])if("server_info"!==e["janus"])if("ack"!==e["janus"])if("success"!==e["janus"])if("trickle"===e["janus"]){var i=e["sender"];if(!i)return void p.warn("Missing sender...");var o=T[i];if(!o)return void p.debug("This handle is not attached to this session");var a=e["candidate"];p.debug("Got a trickled candidate on session "+k),p.debug(a);var s=o.webrtcStuff;s.pc&&s.remoteSdp?(p.debug("Adding remote candidate:",a),a&&!0!==a.completed?s.pc.addIceCandidate(a):s.pc.addIceCandidate(p.endOfCandidates)):(p.debug("We didn't do setRemoteDescription (trickle got here before the offer?), caching candidate"),s.candidates||(s.candidates=[]),s.candidates.push(a),p.debug(s.candidates))}else{if("webrtcup"===e["janus"]){p.debug("Got a webrtcup event on session "+k),p.debug(e);var c=e["sender"];if(!c)return void p.warn("Missing sender...");var d=T[c];return d?void d.webrtcState(!0):void p.debug("This handle is not attached to this session")}if("hangup"===e["janus"]){p.debug("Got a hangup event on session "+k),p.debug(e);var u=e["sender"];if(!u)return void p.warn("Missing sender...");var l=T[u];if(!l)return void p.debug("This handle is not attached to this session");l.webrtcState(!1,e["reason"]),l.hangup()}else if("detached"===e["janus"]){p.debug("Got a detached event on session "+k),p.debug(e);var f=e["sender"];if(!f)return void p.warn("Missing sender...");var v=T[f];if(!v)return;v.ondetached(),v.detach()}else if("media"===e["janus"]){p.debug("Got a media event on session "+k),p.debug(e);var h=e["sender"];if(!h)return void p.warn("Missing sender...");var m=T[h];if(!m)return void p.debug("This handle is not attached to this session");m.mediaState(e["type"],e["receiving"],e["mid"])}else if("slowlink"===e["janus"]){p.debug("Got a slowlink event on session "+k),p.debug(e);var g=e["sender"];if(!g)return void p.warn("Missing sender...");var y=T[g];if(!y)return void p.debug("This handle is not attached to this session");y.slowLink(e["uplink"],e["lost"],e["mid"])}else{if("error"===e["janus"]){p.error("Ooops: "+e["error"].code+" "+e["error"].reason),p.debug(e);var b=e["transaction"];if(b){var S=D[b];S&&S(e),delete D[b]}return}if("event"===e["janus"]){p.debug("Got a plugin event on session "+k),p.debug(e);var C=e["sender"];if(!C)return void p.warn("Missing sender...");var w=e["plugindata"];if(!w)return void p.warn("Missing plugindata...");p.debug("  -- Event is coming from "+C+" ("+w["plugin"]+")");var R=w["data"];p.debug(R);var x=T[C];if(!x)return void p.warn("This handle is not attached to this session");var I=e["jsep"];I&&(p.debug("Handling SDP as well..."),p.debug(I));var _=x.onmessage;_?(p.debug("Notifying application..."),_(R,I)):p.debug("No provided notification callback")}else{if("timeout"===e["janus"])return p.error("Timeout on session "+k),p.debug(e),void(t&&r.close(3504,"Gateway timeout"));p.warn("Unknown message/event  '"+e["janus"]+"' on session "+k),p.debug(e)}}}else{p.debug("Got a success on session "+k),p.debug(e);var M=e["transaction"];if(M){var O=D[M];O&&O(e),delete D[M]}}else{p.debug("Got an ack on session "+k),p.debug(e);var L=e["transaction"];if(L){var j=D[L];j&&j(e),delete D[L]}}else{p.debug("Got info on the Janus instance"),p.debug(e);var U=e["transaction"];if(U){var V=D[U];V&&V(e),delete D[U]}}else p.vdebug("Got a keepalive on session "+k);else for(var N=0;N<e.length;N++)E(e[N],!0)}function x(){if(s&&t&&w){i=setTimeout(x,b);var e={janus:"keepalive",session_id:k,transaction:p.randomString(12)};g&&(e["token"]=g),y&&(e["apisecret"]=y),r.send(JSON.stringify(e))}}function I(c){var d=p.randomString(12),u={janus:"create",transaction:d};if(c["reconnect"]&&(w=!1,u["janus"]="claim",u["session_id"]=k,r&&(r.onopen=null,r.onerror=null,r.onclose=null,i&&(clearTimeout(i),i=null))),g&&(u["token"]=g),y&&(u["apisecret"]=y),!s&&p.isArray(o)&&(s=o[a],0===s.indexOf("ws")?(t=!0,p.log("Server #"+(a+1)+": trying WebSockets to contact Janus ("+s+")")):(t=!1,p.log("Server #"+(a+1)+": trying REST API to contact Janus ("+s+")"))),t)for(var l in r=p.newWebSocket(s,"janus-protocol"),n={error:function(){if(p.error("Error connecting to the Janus WebSockets server... "+s),p.isArray(o)&&!c["reconnect"])return a++,a===o.length?void c.error("Error connecting to any of the provided Janus servers: Is the server down?"):(s=null,void setTimeout((function(){I(c)}),200));c.error("Error connecting to the Janus WebSockets server: Is the server down?")},open:function(){D[d]=function(e){if(p.debug(e),"success"!==e["janus"])return p.error("Ooops: "+e["error"].code+" "+e["error"].reason),void c.error(e["error"].reason);i=setTimeout(x,b),w=!0,k=e["session_id"]?e["session_id"]:e.data["id"],c["reconnect"]?p.log("Claimed session: "+k):p.log("Created session: "+k),p.sessions[k]=R,c.success()},r.send(JSON.stringify(u))},message:function(e){E(JSON.parse(e.data))},close:function(){s&&w&&(w=!1,e.error("Lost connection to the server (is it down?)"))}},n)r.addEventListener(l,n[l]);else p.httpAPICall(s,{verb:"POST",withCredentials:h,body:u,success:function(e){if(p.debug(e),"success"!==e["janus"])return p.error("Ooops: "+e["error"].code+" "+e["error"].reason),void c.error(e["error"].reason);w=!0,k=e["session_id"]?e["session_id"]:e.data["id"],c["reconnect"]?p.log("Claimed session: "+k):p.log("Created session: "+k),p.sessions[k]=R,A(),c.success()},error:function(e,t){if(p.error(e+":",t),p.isArray(o)&&!c["reconnect"])return a++,a===o.length?void c.error("Error connecting to any of the provided Janus servers: Is the server down?"):(s=null,void setTimeout((function(){I(c)}),200));""===t?c.error(e+": Is the server down?"):t&&t.error?c.error(e+": "+t.error.message):c.error(e+": "+t)}})}function _(e){if(e=e||{},e.success="function"==typeof e.success?e.success:p.noop,e.error="function"==typeof e.error?e.error:p.noop,p.log("Getting info on Janus instance"),!w)return p.warn("Is the server down? (connected=false)"),void e.error("Is the server down? (connected=false)");var n=p.randomString(12),i={janus:"info",transaction:n};if(g&&(i["token"]=g),y&&(i["apisecret"]=y),t)return D[n]=function(t){p.log("Server info:"),p.debug(t),"server_info"!==t["janus"]&&p.error("Ooops: "+t["error"].code+" "+t["error"].reason),e.success(t)},void r.send(JSON.stringify(i));p.httpAPICall(s,{verb:"POST",withCredentials:h,body:i,success:function(t){p.log("Server info:"),p.debug(t),"server_info"!==t["janus"]&&p.error("Ooops: "+t["error"].code+" "+t["error"].reason),e.success(t)},error:function(t,r){p.error(t+":",r),""===r?e.error(t+": Is the server down?"):e.error(t+": "+r)}})}function M(o){o=o||{},o.success="function"==typeof o.success?o.success:p.noop,o.error="function"==typeof o.error?o.error:p.noop;var a=!0===o.unload,c=!0;void 0!==o.notifyDestroyed&&null!==o.notifyDestroyed&&(c=!0===o.notifyDestroyed);var d=!0===o.cleanupHandles;if(p.log("Destroying session "+k+" (unload="+a+")"),!k)return p.warn("No session to destroy"),o.success(),void(c&&e.destroyed());if(d)for(var u in T)F(u,{noRequest:!0});if(!w)return p.warn("Is the server down? (connected=false)"),k=null,void o.success();var l={janus:"destroy",transaction:p.randomString(12)};if(g&&(l["token"]=g),y&&(l["apisecret"]=y),a)return t?(r.onclose=null,r.close(),r=null):navigator.sendBeacon(s+"/"+k,JSON.stringify(l)),p.log("Destroyed session:"),k=null,w=!1,o.success(),void(c&&e.destroyed());if(t){l["session_id"]=k;var f=function(){for(var e in n)r.removeEventListener(e,n[e]);r.removeEventListener("message",v),r.removeEventListener("error",m),i&&clearTimeout(i),r.close()},v=function(t){var r=JSON.parse(t.data);r.session_id==l.session_id&&r.transaction==l.transaction&&(f(),o.success(),c&&e.destroyed())},m=function(){f(),o.error("Failed to destroy the server: Is the server down?"),c&&e.destroyed()};return r.addEventListener("message",v),r.addEventListener("error",m),void(1===r.readyState?r.send(JSON.stringify(l)):m())}p.httpAPICall(s+"/"+k,{verb:"POST",withCredentials:h,body:l,success:function(t){p.log("Destroyed session:"),p.debug(t),k=null,w=!1,"success"!==t["janus"]&&p.error("Ooops: "+t["error"].code+" "+t["error"].reason),o.success(),c&&e.destroyed()},error:function(t,r){p.error(t+":",r),k=null,w=!1,o.success(),c&&e.destroyed()}})}function O(e){if(e=e||{},e.success="function"==typeof e.success?e.success:p.noop,e.error="function"==typeof e.error?e.error:p.noop,e.dataChannelOptions=e.dataChannelOptions||{ordered:!0},e.consentDialog="function"==typeof e.consentDialog?e.consentDialog:p.noop,e.iceState="function"==typeof e.iceState?e.iceState:p.noop,e.mediaState="function"==typeof e.mediaState?e.mediaState:p.noop,e.webrtcState="function"==typeof e.webrtcState?e.webrtcState:p.noop,e.slowLink="function"==typeof e.slowLink?e.slowLink:p.noop,e.onmessage="function"==typeof e.onmessage?e.onmessage:p.noop,e.onlocaltrack="function"==typeof e.onlocaltrack?e.onlocaltrack:p.noop,e.onremotetrack="function"==typeof e.onremotetrack?e.onremotetrack:p.noop,e.ondata="function"==typeof e.ondata?e.ondata:p.noop,e.ondataopen="function"==typeof e.ondataopen?e.ondataopen:p.noop,e.oncleanup="function"==typeof e.oncleanup?e.oncleanup:p.noop,e.ondetached="function"==typeof e.ondetached?e.ondetached:p.noop,!w)return p.warn("Is the server down? (connected=false)"),void e.error("Is the server down? (connected=false)");var n=e.plugin;if(!n)return p.error("Invalid plugin"),void e.error("Invalid plugin");var i=e.opaqueId,o=e.loopIndex,a=e.token?e.token:g,c=p.randomString(12),d={janus:"attach",plugin:n,opaque_id:i,loop_index:o,transaction:c};if(a&&(d["token"]=a),y&&(d["apisecret"]=y),t)return D[c]=function(t){if(p.debug(t),"success"!==t["janus"])return p.error("Ooops: "+t["error"].code+" "+t["error"].reason),void e.error("Ooops: "+t["error"].code+" "+t["error"].reason);var r=t.data["id"];p.log("Created handle: "+r);var i={session:R,plugin:n,id:r,token:a,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannelOptions:e.dataChannelOptions,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,bitrate:{}},getId:function(){return r},getPlugin:function(){return n},getVolume:function(e,t){return W(r,e,!0,t)},getRemoteVolume:function(e,t){return W(r,e,!0,t)},getLocalVolume:function(e,t){return W(r,e,!1,t)},isAudioMuted:function(e){return H(r,e,!1)},muteAudio:function(e){return K(r,e,!1,!0)},unmuteAudio:function(e){return K(r,e,!1,!1)},isVideoMuted:function(e){return H(r,e,!0)},muteVideo:function(e){return K(r,e,!0,!0)},unmuteVideo:function(e){return K(r,e,!0,!1)},getBitrate:function(e){return $(r,e)},send:function(e){L(r,e)},data:function(e){V(r,e)},dtmf:function(e){N(r,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){z(r,!0,e)},createAnswer:function(e){z(r,!1,e)},handleRemoteJsep:function(e){J(r,e)},onlocaltrack:e.onlocaltrack,onremotetrack:e.onremotetrack,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){Y(r,!0===e)},detach:function(e){F(r,e)}};T[r]=i,e.success(i)},d["session_id"]=k,void r.send(JSON.stringify(d));p.httpAPICall(s+"/"+k,{verb:"POST",withCredentials:h,body:d,success:function(t){if(p.debug(t),"success"!==t["janus"])return p.error("Ooops: "+t["error"].code+" "+t["error"].reason),void e.error("Ooops: "+t["error"].code+" "+t["error"].reason);var r=t.data["id"];p.log("Created handle: "+r);var i={session:R,plugin:n,id:r,token:a,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannelOptions:e.dataChannelOptions,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,bitrate:{}},getId:function(){return r},getPlugin:function(){return n},getVolume:function(e,t){return W(r,e,!0,t)},getRemoteVolume:function(e,t){return W(r,e,!0,t)},getLocalVolume:function(e,t){return W(r,e,!1,t)},isAudioMuted:function(e){return H(r,e,!1)},muteAudio:function(e){return K(r,e,!1,!0)},unmuteAudio:function(e){return K(r,e,!1,!1)},isVideoMuted:function(e){return H(r,e,!0)},muteVideo:function(e){return K(r,e,!0,!0)},unmuteVideo:function(e){return K(r,e,!0,!1)},getBitrate:function(e){return $(r,e)},send:function(e){L(r,e)},data:function(e){V(r,e)},dtmf:function(e){N(r,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){z(r,!0,e)},createAnswer:function(e){z(r,!1,e)},handleRemoteJsep:function(e){J(r,e)},onlocaltrack:e.onlocaltrack,onremotetrack:e.onremotetrack,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){Y(r,!0===e)},detach:function(e){F(r,e)}};T[r]=i,e.success(i)},error:function(t,r){p.error(t+":",r),""===r?e.error(t+": Is the server down?"):e.error(t+": "+r)}})}function L(e,n){if(n=n||{},n.success="function"==typeof n.success?n.success:p.noop,n.error="function"==typeof n.error?n.error:p.noop,!w)return p.warn("Is the server down? (connected=false)"),void n.error("Is the server down? (connected=false)");var i=T[e];if(!i||!i.webrtcStuff)return p.warn("Invalid handle"),void n.error("Invalid handle");var o=n.message,a=n.jsep,c=p.randomString(12),d={janus:"message",body:o,transaction:c};if(i.token&&(d["token"]=i.token),y&&(d["apisecret"]=y),a&&(d.jsep={type:a.type,sdp:a.sdp},a.e2ee&&(d.jsep.e2ee=!0),"hml"!==a.rid_order&&"lmh"!==a.rid_order||(d.jsep.rid_order=a.rid_order),a.force_relay&&(d.jsep.force_relay=!0)),p.debug("Sending message to plugin (handle="+e+"):"),p.debug(d),t)return d["session_id"]=k,d["handle_id"]=e,D[c]=function(e){if(p.debug("Message sent!"),p.debug(e),"success"===e["janus"]){var t=e["plugindata"];if(!t)return p.warn("Request succeeded, but missing plugindata..."),void n.success();p.log("Synchronous transaction successful ("+t["plugin"]+")");var r=t["data"];return p.debug(r),void n.success(r)}"ack"===e["janus"]?n.success():e["error"]?(p.error("Ooops: "+e["error"].code+" "+e["error"].reason),n.error(e["error"].code+" "+e["error"].reason)):(p.error("Unknown error"),n.error("Unknown error"))},void r.send(JSON.stringify(d));p.httpAPICall(s+"/"+k+"/"+e,{verb:"POST",withCredentials:h,body:d,success:function(e){if(p.debug("Message sent!"),p.debug(e),"success"===e["janus"]){var t=e["plugindata"];if(!t)return p.warn("Request succeeded, but missing plugindata..."),void n.success();p.log("Synchronous transaction successful ("+t["plugin"]+")");var r=t["data"];return p.debug(r),void n.success(r)}"ack"===e["janus"]?n.success():e["error"]?(p.error("Ooops: "+e["error"].code+" "+e["error"].reason),n.error(e["error"].code+" "+e["error"].reason)):(p.error("Unknown error"),n.error("Unknown error"))},error:function(e,t){p.error(e+":",t),n.error(e+": "+t)}})}function j(e,n){if(w){var i=T[e];if(i&&i.webrtcStuff){var o={janus:"trickle",candidate:n,transaction:p.randomString(12)};if(i.token&&(o["token"]=i.token),y&&(o["apisecret"]=y),p.vdebug("Sending trickle candidate (handle="+e+"):"),p.vdebug(o),t)return o["session_id"]=k,o["handle_id"]=e,void r.send(JSON.stringify(o));p.httpAPICall(s+"/"+k+"/"+e,{verb:"POST",withCredentials:h,body:o,success:function(e){p.vdebug("Candidate sent!"),p.vdebug(e),"ack"===e["janus"]||p.error("Ooops: "+e["error"].code+" "+e["error"].reason)},error:function(e,t){p.error(e+":",t)}})}else p.warn("Invalid handle")}else p.warn("Is the server down? (connected=false)")}function U(e,t,r,n,i){var o=T[e];if(o&&o.webrtcStuff){var a=o.webrtcStuff;if(a.pc){var s=function(e){p.log("Received message on data channel:",e);var t=e.target.label;o.ondata(e.data,t)},d=function(e){p.log("Received state change on data channel:",e);var t=e.target.label,r=e.target.protocol,n=a.dataChannel[t]?a.dataChannel[t].readyState:"null";if(p.log("State change on <"+t+"> data channel: "+n),"open"===n){if(a.dataChannel[t].pending&&a.dataChannel[t].pending.length>0){p.log("Sending pending messages on <"+t+">:",a.dataChannel[t].pending.length);var i,s=(0,c.Z)(a.dataChannel[t].pending);try{for(s.s();!(i=s.n()).done;){var d=i.value;p.log("Sending data on data channel <"+t+">"),p.debug(d),a.dataChannel[t].send(d)}}catch(u){s.e(u)}finally{s.f()}a.dataChannel[t].pending=[]}o.ondataopen(t,r)}},u=function(e){p.error("Got error on data channel:",e)};if(n)a.dataChannel[t]=n;else{var l=a.dataChannelOptions;r&&(l.protocol=r),a.dataChannel[t]=a.pc.createDataChannel(t,l)}a.dataChannel[t].onmessage=s,a.dataChannel[t].onopen=d,a.dataChannel[t].onclose=d,a.dataChannel[t].onerror=u,a.dataChannel[t].pending=[],i&&a.dataChannel[t].pending.push(i)}else p.warn("Invalid PeerConnection")}else p.warn("Invalid handle")}function V(e,t){t=t||{},t.success="function"==typeof t.success?t.success:p.noop,t.error="function"==typeof t.error?t.error:p.noop;var r=T[e];if(!r||!r.webrtcStuff)return p.warn("Invalid handle"),void t.error("Invalid handle");var n=r.webrtcStuff,i=t.text||t.data;if(!i)return p.warn("Invalid data"),void t.error("Invalid data");var o=t.label?t.label:p.dataChanDefaultLabel;return n.dataChannel[o]?"open"!==n.dataChannel[o].readyState?(n.dataChannel[o].pending.push(i),void t.success()):(p.log("Sending data on data channel <"+o+">"),p.debug(i),n.dataChannel[o].send(i),void t.success()):(U(e,o,t.protocol,!1,i,t.protocol),void t.success())}function N(e,t){t=t||{},t.success="function"==typeof t.success?t.success:p.noop,t.error="function"==typeof t.error?t.error:p.noop;var r=T[e];if(!r||!r.webrtcStuff)return p.warn("Invalid handle"),void t.error("Invalid handle");var n=r.webrtcStuff;if(!n.dtmfSender){if(n.pc){var i=n.pc.getSenders(),o=i.find((function(e){return e.track&&"audio"===e.track.kind}));if(!o)return p.warn("Invalid DTMF configuration (no audio track)"),void t.error("Invalid DTMF configuration (no audio track)");n.dtmfSender=o.dtmf,n.dtmfSender&&(p.log("Created DTMF Sender"),n.dtmfSender.ontonechange=function(e){p.debug("Sent DTMF tone: "+e.tone)})}if(!n.dtmfSender)return p.warn("Invalid DTMF configuration"),void t.error("Invalid DTMF configuration")}var a=t.dtmf;if(!a)return p.warn("Invalid DTMF parameters"),void t.error("Invalid DTMF parameters");var s=a.tones;if(!s)return p.warn("Invalid DTMF string"),void t.error("Invalid DTMF string");var c="number"===typeof a.duration?a.duration:500,d="number"===typeof a.gap?a.gap:50;p.debug("Sending DTMF string "+s+" (duration "+c+"ms, gap "+d+"ms)"),n.dtmfSender.insertDTMF(s,c,d),t.success()}function F(e,n){n=n||{},n.success="function"==typeof n.success?n.success:p.noop,n.error="function"==typeof n.error?n.error:p.noop;var i=!0===n.noRequest;p.log("Destroying handle "+e+" (only-locally="+i+")"),Y(e);var o=T[e];if(!o||o.detached)return delete T[e],void n.success();if(o.detached=!0,i)return delete T[e],void n.success();if(!w)return p.warn("Is the server down? (connected=false)"),void n.error("Is the server down? (connected=false)");var a={janus:"detach",transaction:p.randomString(12)};if(o.token&&(a["token"]=o.token),y&&(a["apisecret"]=y),t)return a["session_id"]=k,a["handle_id"]=e,r.send(JSON.stringify(a)),delete T[e],void n.success();p.httpAPICall(s+"/"+k+"/"+e,{verb:"POST",withCredentials:h,body:a,success:function(t){p.log("Destroyed handle:"),p.debug(t),"success"!==t["janus"]&&p.error("Ooops: "+t["error"].code+" "+t["error"].reason),delete T[e],n.success()},error:function(t,r){p.error(t+":",r),delete T[e],n.success()}})}function Z(e,t,r,n,i){var o=T[e];if(!o||!o.webrtcStuff)return p.warn("Invalid handle"),n.stream||p.stopAllTracks(i),void n.error("Invalid handle");var a=o.webrtcStuff;p.debug("streamsDone:",i),i&&(p.debug("  -- Audio tracks:",i.getAudioTracks()),p.debug("  -- Video tracks:",i.getVideoTracks()));var s=!1;if(a.myStream&&r.update&&(!a.streamExternal||r.replaceAudio||r.replaceVideo)){if((!r.update&&ee(r)||r.update&&(r.addAudio||r.replaceAudio))&&i.getAudioTracks()&&i.getAudioTracks().length)if(a.myStream.addTrack(i.getAudioTracks()[0]),p.unifiedPlan){p.log((r.replaceAudio?"Replacing":"Adding")+" audio track:",i.getAudioTracks()[0]);var h=null,m=a.pc.getTransceivers();if(m&&m.length>0){var g,y=(0,c.Z)(m);try{for(y.s();!(g=y.n()).done;){var b=g.value;if(b.sender&&b.sender.track&&"audio"===b.sender.track.kind||b.receiver&&b.receiver.track&&"audio"===b.receiver.track.kind){h=b;break}}}catch(L){y.e(L)}finally{y.f()}}h&&h.sender?h.sender.replaceTrack(i.getAudioTracks()[0]):a.pc.addTrack(i.getAudioTracks()[0],i)}else p.log((r.replaceAudio?"Replacing":"Adding")+" audio track:",i.getAudioTracks()[0]),a.pc.addTrack(i.getAudioTracks()[0],i);if((!r.update&&ne(r)||r.update&&(r.addVideo||r.replaceVideo))&&i.getVideoTracks()&&i.getVideoTracks().length)if(a.myStream.addTrack(i.getVideoTracks()[0]),p.unifiedPlan){p.log((r.replaceVideo?"Replacing":"Adding")+" video track:",i.getVideoTracks()[0]);var S=null,w=a.pc.getTransceivers();if(w&&w.length>0){var k,R=(0,c.Z)(w);try{for(R.s();!(k=R.n()).done;){var P=k.value;if(P.sender&&P.sender.track&&"video"===P.sender.track.kind||P.receiver&&P.receiver.track&&"video"===P.receiver.track.kind){S=P;break}}}catch(L){R.e(L)}finally{R.f()}}S&&S.sender?S.sender.replaceTrack(i.getVideoTracks()[0]):a.pc.addTrack(i.getVideoTracks()[0],i)}else p.log((r.replaceVideo?"Replacing":"Adding")+" video track:",i.getVideoTracks()[0]),a.pc.addTrack(i.getVideoTracks()[0],i)}else a.myStream=i,s=!0;if(!a.pc){var D={iceServers:u,iceTransportPolicy:l,bundlePolicy:f};"chrome"===p.webRTCAdapter.browserDetails.browser&&(D["sdpSemantics"]=p.webRTCAdapter.browserDetails.version<72?"plan-b":"unified-plan");var A={optional:[{DtlsSrtpKeyAgreement:!0}]};if(v&&A.optional.push({googIPv6:!0}),n.rtcConstraints&&"object"===(0,d.Z)(n.rtcConstraints))for(var E in p.debug("Adding custom PeerConnection constraints:",n.rtcConstraints),n.rtcConstraints)A.optional.push(n.rtcConstraints[E]);"edge"===p.webRTCAdapter.browserDetails.browser&&(D.bundlePolicy="max-bundle"),RTCRtpSender&&(RTCRtpSender.prototype.createEncodedStreams||RTCRtpSender.prototype.createEncodedAudioStreams&&RTCRtpSender.prototype.createEncodedVideoStreams)&&(n.senderTransforms||n.receiverTransforms)&&(a.senderTransforms=n.senderTransforms,a.receiverTransforms=n.receiverTransforms,D["forceEncodedAudioInsertableStreams"]=!0,D["forceEncodedVideoInsertableStreams"]=!0,D["encodedInsertableStreams"]=!0),p.log("Creating PeerConnection"),p.debug(A),a.pc=new RTCPeerConnection(D,A),p.debug(a.pc),a.pc.getStats&&(a.volume={},a.bitrate.value="0 kbits/sec"),p.log("Preparing local SDP and gathering candidates (trickle="+a.trickle+")"),a.pc.oniceconnectionstatechange=function(){a.pc&&o.iceState(a.pc.iceConnectionState)},a.pc.onicecandidate=function(t){if(!t.candidate||"edge"===p.webRTCAdapter.browserDetails.browser&&t.candidate.candidate.indexOf("endOfCandidates")>0)p.log("End of candidates."),a.iceDone=!0,!0===a.trickle?j(e,{completed:!0}):B(e,n);else{var r={candidate:t.candidate.candidate,sdpMid:t.candidate.sdpMid,sdpMLineIndex:t.candidate.sdpMLineIndex};!0===a.trickle&&j(e,r)}},a.pc.ontrack=function(e){if(p.log("Handling Remote Track"),p.debug(e),e.streams&&(a.remoteStream=e.streams[0],e.track)){var t=e.transceiver?e.transceiver.mid:e.track.id;try{o.onremotetrack(e.track,t,!0)}catch(i){p.error(i)}if(!e.track.onended){if(a.receiverTransforms){var r=null;RTCRtpSender.prototype.createEncodedStreams?r=e.receiver.createEncodedStreams():(RTCRtpSender.prototype.createAudioEncodedStreams||RTCRtpSender.prototype.createEncodedVideoStreams)&&("audio"===e.track.kind&&a.receiverTransforms["audio"]?r=e.receiver.createEncodedAudioStreams():"video"===e.track.kind&&a.receiverTransforms["video"]&&(r=e.receiver.createEncodedVideoStreams())),r&&(console.log(r),r.readableStream&&r.writableStream?r.readableStream.pipeThrough(a.receiverTransforms[e.track.kind]).pipeTo(r.writableStream):r.readable&&r.writable&&r.readable.pipeThrough(a.receiverTransforms[e.track.kind]).pipeTo(r.writable))}var n=null;p.log("Adding onended callback to track:",e.track),e.track.onended=function(e){if(p.log("Remote track removed:",e),a.remoteStream){clearTimeout(n),a.remoteStream.removeTrack(e.target);var t=e.target.id;if(p.unifiedPlan){var r=a.pc.getTransceivers().find((function(t){return t.receiver.track===e.target}));t=r.mid}try{o.onremotetrack(e.target,t,!1)}catch(i){p.error(i)}}},e.track.onmute=function(e){p.log("Remote track muted:",e),a.remoteStream&&null==n&&(n=setTimeout((function(){if(p.log("Removing remote track"),a.remoteStream){a.remoteStream.removeTrack(e.target);var t=e.target.id;if(p.unifiedPlan){var r=a.pc.getTransceivers().find((function(t){return t.receiver.track===e.target}));t=r.mid}try{o.onremotetrack(e.target,t,!1)}catch(i){p.error(i)}}n=null}),2520))},e.track.onunmute=function(e){if(p.log("Remote track flowing again:",e),null!=n)clearTimeout(n),n=null;else try{a.remoteStream.addTrack(e.target);var t=e.target.id;if(p.unifiedPlan){var r=a.pc.getTransceivers().find((function(t){return t.receiver.track===e.target}));t=r.mid}o.onremotetrack(e.target,t,!0)}catch(i){p.error(i)}}}}}}if(s&&i){p.log("Adding local stream");var x=(!0===n.simulcast||!0===n.simulcast2)&&p.unifiedPlan,I=n.svc;i.getTracks().forEach((function(e){p.log("Adding local track:",e);var t=null;if(!x&&!I||"audio"===e.kind)t=a.pc.addTrack(e,i);else if(x){p.log("Enabling rid-based simulcasting:",e);var r=C(n.simulcastMaxBitrates),o=a.pc.addTransceiver(e,{direction:"sendrecv",streams:[i],sendEncodings:n.sendEncodings||[{rid:"h",active:!0,maxBitrate:r.high},{rid:"m",active:!0,maxBitrate:r.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:r.low,scaleResolutionDownBy:4}]});o&&(t=o.sender)}else{p.log("Enabling SVC ("+I+"):",e);var s=a.pc.addTransceiver(e,{direction:"sendrecv",streams:[i],sendEncodings:[{scalabilityMode:I}]});s&&(t=s.sender)}if(t&&a.senderTransforms){var c=null;RTCRtpSender.prototype.createEncodedStreams?c=t.createEncodedStreams():(RTCRtpSender.prototype.createAudioEncodedStreams||RTCRtpSender.prototype.createEncodedVideoStreams)&&("audio"===t.track.kind&&a.senderTransforms["audio"]?c=t.createEncodedAudioStreams():"video"===t.track.kind&&a.senderTransforms["video"]&&(c=t.createEncodedVideoStreams())),c&&(console.log(c),c.readableStream&&c.writableStream?c.readableStream.pipeThrough(a.senderTransforms[t.track.kind]).pipeTo(c.writableStream):c.readable&&c.writable&&c.readable.pipeThrough(a.senderTransforms[t.track.kind]).pipeTo(c.writable))}}))}if(se(r)&&!a.dataChannel[p.dataChanDefaultLabel]&&(p.log("Creating default data channel"),U(e,p.dataChanDefaultLabel,null,!1),a.pc.ondatachannel=function(t){p.log("Data channel created by Janus:",t),U(e,t.channel.label,t.channel.protocol,t.channel)}),a.myStream){var _=a.myStream.getTracks();for(var M in _){var O=_[M];O.onended=function(e){p.log("Local track removed:",e);try{o.onlocaltrack(e.target,!1)}catch(t){p.error(t)}};try{o.onlocaltrack(O,!0)}catch(V){p.error(V)}}}t?a.pc.setRemoteDescription(t).then((function(){if(p.log("Remote description accepted!"),a.remoteSdp=t.sdp,a.candidates&&a.candidates.length>0){for(var i=0;i<a.candidates.length;i++){var o=a.candidates[i];p.debug("Adding remote candidate:",o),o&&!0!==o.completed?a.pc.addIceCandidate(o):a.pc.addIceCandidate(p.endOfCandidates)}a.candidates=[]}q(e,r,n)}),n.error):G(e,r,n)}function z(e,t,r){r=r||{},r.success="function"==typeof r.success?r.success:p.noop,r.error="function"==typeof r.error?r.error:Q;var n=r.jsep;if(t&&n)return p.error("Provided a JSEP to a createOffer"),void r.error("Provided a JSEP to a createOffer");if(!t&&(!n||!n.type||!n.sdp))return p.error("A valid JSEP is required for createAnswer"),void r.error("A valid JSEP is required for createAnswer");r.media="object"===(0,d.Z)(r.media)&&r.media?r.media:{audio:!0,video:!0};var i=r.media,o=T[e];if(!o||!o.webrtcStuff)return p.warn("Invalid handle"),void r.error("Invalid handle");var a=o.webrtcStuff;if(a.trickle=ce(r.trickle),a.pc){if(p.log("Updating existing media session"),i.update=!0,r.stream)r.stream!==a.myStream&&p.log("Renegotiation involves a new external stream");else{if(i.addAudio){if(i.keepAudio=!1,i.replaceAudio=!1,i.removeAudio=!1,i.audioSend=!0,a.myStream&&a.myStream.getAudioTracks()&&a.myStream.getAudioTracks().length)return p.error("Can't add audio stream, there already is one"),void r.error("Can't add audio stream, there already is one")}else i.removeAudio?(i.keepAudio=!1,i.replaceAudio=!1,i.addAudio=!1,i.audioSend=!1):i.replaceAudio&&(i.keepAudio=!1,i.addAudio=!1,i.removeAudio=!1,i.audioSend=!0);if(a.myStream&&a.myStream.getAudioTracks()&&0!==a.myStream.getAudioTracks().length?!ee(i)||i.removeAudio||i.replaceAudio||(i.keepAudio=!0):(i.replaceAudio&&(i.keepAudio=!1,i.replaceAudio=!1,i.addAudio=!0,i.audioSend=!0),ee(i)&&(i.keepAudio=!1,i.addAudio=!0)),i.addVideo){if(i.keepVideo=!1,i.replaceVideo=!1,i.removeVideo=!1,i.videoSend=!0,a.myStream&&a.myStream.getVideoTracks()&&a.myStream.getVideoTracks().length)return p.error("Can't add video stream, there already is one"),void r.error("Can't add video stream, there already is one")}else i.removeVideo?(i.keepVideo=!1,i.replaceVideo=!1,i.addVideo=!1,i.videoSend=!1):i.replaceVideo&&(i.keepVideo=!1,i.addVideo=!1,i.removeVideo=!1,i.videoSend=!0);a.myStream&&a.myStream.getVideoTracks()&&0!==a.myStream.getVideoTracks().length?!ne(i)||i.removeVideo||i.replaceVideo||(i.keepVideo=!0):(i.replaceVideo&&(i.keepVideo=!1,i.replaceVideo=!1,i.addVideo=!0,i.videoSend=!0),ne(i)&&(i.keepVideo=!1,i.addVideo=!0)),i.addData&&(i.data=!0)}if(ee(i)&&i.keepAudio&&ne(i)&&i.keepVideo)return o.consentDialog(!1),void Z(e,n,i,r,a.myStream)}else i.update=!1,i.keepAudio=!1,i.keepVideo=!1;if(i.update&&(!a.streamExternal||a.streamExternal&&(i.replaceAudio||i.replaceVideo))){if(i.removeAudio||i.replaceAudio){if(a.myStream&&a.myStream.getAudioTracks()&&a.myStream.getAudioTracks().length){var s=a.myStream.getAudioTracks()[0];p.log("Removing audio track:",s),a.myStream.removeTrack(s);try{o.onlocaltrack(s,!1)}catch(O){p.error(O)}try{s.stop()}catch(O){}}if(a.pc.getSenders()&&a.pc.getSenders().length){var u=!0;if(i.replaceAudio&&p.unifiedPlan&&(u=!1),u){var l,f=(0,c.Z)(a.pc.getSenders());try{for(f.s();!(l=f.n()).done;){var v=l.value;v&&v.track&&"audio"===v.track.kind&&(p.log("Removing audio sender:",v),a.pc.removeTrack(v))}}catch(L){f.e(L)}finally{f.f()}}}}if(i.removeVideo||i.replaceVideo){if(a.myStream&&a.myStream.getVideoTracks()&&a.myStream.getVideoTracks().length){var h=a.myStream.getVideoTracks()[0];p.log("Removing video track:",h),a.myStream.removeTrack(h);try{o.onlocaltrack(h,!1)}catch(O){p.error(O)}try{h.stop()}catch(O){}}if(a.pc.getSenders()&&a.pc.getSenders().length){var m=!0;if(i.replaceVideo&&p.unifiedPlan&&(m=!1),m){var g,y=(0,c.Z)(a.pc.getSenders());try{for(y.s();!(g=y.n()).done;){var b=g.value;b&&b.track&&"video"===b.track.kind&&(p.log("Removing video sender:",b),a.pc.removeTrack(b))}}catch(L){y.e(L)}finally{y.f()}}}}}if(r.stream){var S=r.stream;return p.log("MediaStream provided by the application"),p.debug(S),!i.update||!a.myStream||a.myStream===r.stream||a.streamExternal||i.replaceAudio||i.replaceVideo||(p.stopAllTracks(a.myStream),a.myStream=null),a.streamExternal=!0,o.consentDialog(!1),void Z(e,n,i,r,S)}if(ee(i)||ne(i)){if(!p.isGetUserMediaAvailable())return void r.error("getUserMedia not available");var C={mandatory:{},optional:[]};o.consentDialog(!0);var w=ee(i);w&&i&&"object"===(0,d.Z)(i.audio)&&(w=i.audio);var k=ne(i);if(k&&i){var R=!0===r.simulcast||!0===r.simulcast2,P=r.svc;if(!R&&!P||n||i.video||(i.video="hires"),i.video&&"screen"!=i.video&&"window"!=i.video)if("object"===(0,d.Z)(i.video))k=i.video;else{var D=0,A=0;"lowres"===i.video?(A=240,D=320):"lowres-16:9"===i.video?(A=180,D=320):"hires"===i.video||"hires-16:9"===i.video||"hdres"===i.video?(A=720,D=1280):"fhdres"===i.video?(A=1080,D=1920):"4kres"===i.video?(A=2160,D=3840):"stdres"===i.video?(A=480,D=640):"stdres-16:9"===i.video?(A=360,D=640):(p.log("Default video setting is stdres 4:3"),A=480,D=640),p.log("Adding media constraint:",i.video),k={height:{ideal:A},width:{ideal:D}},p.log("Adding video constraint:",k)}else if("screen"===i.video||"window"===i.video){if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return C.video={},i.screenshareFrameRate&&(C.video.frameRate=i.screenshareFrameRate),i.screenshareHeight&&(C.video.height=i.screenshareHeight),i.screenshareWidth&&(C.video.width=i.screenshareWidth),C.audio=i.captureDesktopAudio,void navigator.mediaDevices.getDisplayMedia(C).then((function(t){o.consentDialog(!1),ee(i)&&!i.keepAudio?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(o){t.addTrack(o.getAudioTracks()[0]),Z(e,n,i,r,t)})):Z(e,n,i,r,t)}),(function(e){o.consentDialog(!1),r.error(e)}));var E=function(t,a){o.consentDialog(!1),t?r.error(t):Z(e,n,i,r,a)},x=function(e,t,r){p.log("Adding media constraint (screen capture)"),p.debug(e),navigator.mediaDevices.getUserMedia(e).then((function(e){r?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(r){e.addTrack(r.getAudioTracks()[0]),t(null,e)})):t(null,e)})).catch((function(e){o.consentDialog(!1),t(e)}))};if("chrome"===p.webRTCAdapter.browserDetails.browser){var I=p.webRTCAdapter.browserDetails.version,_=33;window.navigator.userAgent.match("Linux")&&(_=35),I>=26&&I<=_?(C={video:{mandatory:{googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:i.screenshareFrameRate,maxFrameRate:i.screenshareFrameRate,chromeMediaSource:"screen"}},audio:ee(i)&&!i.keepAudio},x(C,E)):p.extension.getScreen((function(e,t){if(e)return o.consentDialog(!1),r.error(e);C={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:i.screenshareFrameRate,maxFrameRate:i.screenshareFrameRate},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},C.video.mandatory.chromeMediaSourceId=t,x(C,E,ee(i)&&!i.keepAudio)}))}else if("firefox"===p.webRTCAdapter.browserDetails.browser){if(!(p.webRTCAdapter.browserDetails.version>=33)){var M=new Error("NavigatorUserMediaError");return M.name="Your version of Firefox does not support screen sharing, please install Firefox 33 (or more recent versions)",o.consentDialog(!1),void r.error(M)}C={video:{mozMediaSource:i.video,mediaSource:i.video},audio:ee(i)&&!i.keepAudio},x(C,(function(e,t){if(E(e,t),!e)var r=t.currentTime,n=window.setInterval((function(){t||window.clearInterval(n),t.currentTime==r&&(window.clearInterval(n),t.onended&&t.onended()),r=t.currentTime}),500)}))}return}}i&&"screen"===i.video||navigator.mediaDevices.enumerateDevices().then((function(t){var a=t.some((function(e){return"audioinput"===e.kind})),s=ae(i)||t.some((function(e){return"videoinput"===e.kind})),c=ee(i),d=ne(i),u=te(i),l=ie(i);if(c||d||u||l){var f=!!c&&a,v=!!d&&s;if(!f&&!v)return o.consentDialog(!1),r.error("No capture device found"),!1;if(!f&&u)return o.consentDialog(!1),r.error("Audio capture is required, but no capture device found"),!1;if(!v&&l)return o.consentDialog(!1),r.error("Video capture is required, but no capture device found"),!1}var h={audio:!(!a||i.keepAudio)&&w,video:!(!s||i.keepVideo)&&k};p.debug("getUserMedia constraints",h),h.audio||h.video?navigator.mediaDevices.getUserMedia(h).then((function(t){o.consentDialog(!1),Z(e,n,i,r,t)})).catch((function(e){o.consentDialog(!1),r.error({code:e.code,name:e.name,message:e.message})})):(o.consentDialog(!1),Z(e,n,i,r,S))})).catch((function(e){o.consentDialog(!1),r.error(e)}))}else Z(e,n,i,r)}function J(e,t){t=t||{},t.success="function"==typeof t.success?t.success:p.noop,t.error="function"==typeof t.error?t.error:Q,t.customizeSdp="function"==typeof t.customizeSdp?t.customizeSdp:p.noop;var r=t.jsep,n=T[e];if(!n||!n.webrtcStuff)return p.warn("Invalid handle"),void t.error("Invalid handle");var i=n.webrtcStuff;if(r){if(!i.pc)return p.warn("Wait, no PeerConnection?? if this is an answer, use createAnswer and not handleRemoteJsep"),void t.error("No PeerConnection: if this is an answer, use createAnswer and not handleRemoteJsep");t.customizeSdp(r),i.pc.setRemoteDescription(r).then((function(){if(p.log("Remote description accepted!"),i.remoteSdp=r.sdp,i.candidates&&i.candidates.length>0){for(var e=0;e<i.candidates.length;e++){var n=i.candidates[e];p.debug("Adding remote candidate:",n),n&&!0!==n.completed?i.pc.addIceCandidate(n):i.pc.addIceCandidate(p.endOfCandidates)}i.candidates=[]}t.success()}),t.error)}else t.error("Invalid JSEP")}function G(e,t,r){r=r||{},r.success="function"==typeof r.success?r.success:p.noop,r.error="function"==typeof r.error?r.error:p.noop,r.customizeSdp="function"==typeof r.customizeSdp?r.customizeSdp:p.noop;var n=T[e];if(!n||!n.webrtcStuff)return p.warn("Invalid handle"),void r.error("Invalid handle");var i=n.webrtcStuff,o=!0===r.simulcast||!0===r.simulcast2;o?p.log("Creating offer (iceDone="+i.iceDone+", simulcast="+o+")"):p.log("Creating offer (iceDone="+i.iceDone+")");var a={};if(p.unifiedPlan){var s=null,d=null,u=i.pc.getTransceivers();if(u&&u.length>0){var l,f=(0,c.Z)(u);try{for(f.s();!(l=f.n()).done;){var v=l.value;v.sender&&v.sender.track&&"audio"===v.sender.track.kind||v.receiver&&v.receiver.track&&"audio"===v.receiver.track.kind?s||(s=v):(v.sender&&v.sender.track&&"video"===v.sender.track.kind||v.receiver&&v.receiver.track&&"video"===v.receiver.track.kind)&&(d||(d=v))}}catch(P){f.e(P)}finally{f.f()}}var h=ee(t),m=re(t);h||m?h&&m?s&&(s.setDirection?s.setDirection("sendrecv"):s.direction="sendrecv",p.log("Setting audio transceiver to sendrecv:",s)):h&&!m?s&&(s.setDirection?s.setDirection("sendonly"):s.direction="sendonly",p.log("Setting audio transceiver to sendonly:",s)):!h&&m&&(s?(s.setDirection?s.setDirection("recvonly"):s.direction="recvonly",p.log("Setting audio transceiver to recvonly:",s)):(s=i.pc.addTransceiver("audio",{direction:"recvonly"}),p.log("Adding recvonly audio transceiver:",s))):t.removeAudio&&s&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive",p.log("Setting audio transceiver to inactive:",s));var g=ne(t),y=oe(t);g||y?g&&y?d&&(d.setDirection?d.setDirection("sendrecv"):d.direction="sendrecv",p.log("Setting video transceiver to sendrecv:",d)):g&&!y?d&&(d.setDirection?d.setDirection("sendonly"):d.direction="sendonly",p.log("Setting video transceiver to sendonly:",d)):!g&&y&&(d?(d.setDirection?d.setDirection("recvonly"):d.direction="recvonly",p.log("Setting video transceiver to recvonly:",d)):(d=i.pc.addTransceiver("video",{direction:"recvonly"}),p.log("Adding recvonly video transceiver:",d))):t.removeVideo&&d&&(d.setDirection?d.setDirection("inactive"):d.direction="inactive",p.log("Setting video transceiver to inactive:",d))}else a["offerToReceiveAudio"]=re(t),a["offerToReceiveVideo"]=oe(t);var b=!0===r.iceRestart;b&&(a["iceRestart"]=!0),p.debug(a);var S=ne(t);if(S&&o&&"firefox"===p.webRTCAdapter.browserDetails.browser){p.log("Enabling Simulcasting for Firefox (RID)");var w=i.pc.getSenders().find((function(e){return e.track&&"video"===e.track.kind}));if(w){var k=w.getParameters();k||(k={});var R=C(r.simulcastMaxBitrates);k.encodings=r.sendEncodings||[{rid:"h",active:!0,maxBitrate:R.high},{rid:"m",active:!0,maxBitrate:R.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:R.low,scaleResolutionDownBy:4}],w.setParameters(k)}}i.pc.createOffer(a).then((function(e){p.debug(e);var t={type:e.type,sdp:e.sdp};r.customizeSdp(t),e.sdp=t.sdp,p.log("Setting local description"),S&&o&&!p.unifiedPlan&&("chrome"!==p.webRTCAdapter.browserDetails.browser&&"safari"!==p.webRTCAdapter.browserDetails.browser||(p.log("Enabling Simulcasting for Chrome (SDP munging)"),e.sdp=X(e.sdp))),i.mySdp={type:"offer",sdp:e.sdp},i.pc.setLocalDescription(e).catch(r.error),i.mediaConstraints=a,i.iceDone||i.trickle?((i.senderTransforms||i.receiverTransforms)&&(e["e2ee"]=!0),r.success(e)):p.log("Waiting for all candidates...")}),r.error)}function q(e,t,r){r=r||{},r.success="function"==typeof r.success?r.success:p.noop,r.error="function"==typeof r.error?r.error:p.noop,r.customizeSdp="function"==typeof r.customizeSdp?r.customizeSdp:p.noop;var n=T[e];if(!n||!n.webrtcStuff)return p.warn("Invalid handle"),void r.error("Invalid handle");var i=n.webrtcStuff,o=!0===r.simulcast||!0===r.simulcast2;o?p.log("Creating answer (iceDone="+i.iceDone+", simulcast="+o+")"):p.log("Creating answer (iceDone="+i.iceDone+")");var a=null;if(p.unifiedPlan){a={};var s=null,d=null,u=i.pc.getTransceivers();if(u&&u.length>0){var l,f=(0,c.Z)(u);try{for(f.s();!(l=f.n()).done;){var v=l.value;v.sender&&v.sender.track&&"audio"===v.sender.track.kind||v.receiver&&v.receiver.track&&"audio"===v.receiver.track.kind?s||(s=v):(v.sender&&v.sender.track&&"video"===v.sender.track.kind||v.receiver&&v.receiver.track&&"video"===v.receiver.track.kind)&&(d||(d=v))}}catch(R){f.e(R)}finally{f.f()}}var h=ee(t),m=re(t);if(h||m){if(h&&m){if(s)try{s.setDirection?s.setDirection("sendrecv"):s.direction="sendrecv",p.log("Setting audio transceiver to sendrecv:",s)}catch(P){p.error(P)}}else if(h&&!m)try{s&&(s.setDirection?s.setDirection("sendonly"):s.direction="sendonly",p.log("Setting audio transceiver to sendonly:",s))}catch(P){p.error(P)}else if(!h&&m)if(s)try{s.setDirection?s.setDirection("recvonly"):s.direction="recvonly",p.log("Setting audio transceiver to recvonly:",s)}catch(P){p.error(P)}else s=i.pc.addTransceiver("audio",{direction:"recvonly"}),p.log("Adding recvonly audio transceiver:",s)}else if(t.removeAudio&&s)try{s.setDirection?s.setDirection("inactive"):s.direction="inactive",p.log("Setting audio transceiver to inactive:",s)}catch(P){p.error(P)}var g=ne(t),y=oe(t);if(g||y){if(g&&y){if(d)try{d.setDirection?d.setDirection("sendrecv"):d.direction="sendrecv",p.log("Setting video transceiver to sendrecv:",d)}catch(P){p.error(P)}}else if(g&&!y){if(d)try{d.setDirection?d.setDirection("sendonly"):d.direction="sendonly",p.log("Setting video transceiver to sendonly:",d)}catch(P){p.error(P)}}else if(!g&&y)if(d)try{d.setDirection?d.setDirection("recvonly"):d.direction="recvonly",p.log("Setting video transceiver to recvonly:",d)}catch(P){p.error(P)}else d=i.pc.addTransceiver("video",{direction:"recvonly"}),p.log("Adding recvonly video transceiver:",d)}else if(t.removeVideo&&d)try{d.setDirection?d.setDirection("inactive"):d.direction="inactive",p.log("Setting video transceiver to inactive:",d)}catch(P){p.error(P)}}else a="firefox"===p.webRTCAdapter.browserDetails.browser||"edge"===p.webRTCAdapter.browserDetails.browser?{offerToReceiveAudio:re(t),offerToReceiveVideo:oe(t)}:{mandatory:{OfferToReceiveAudio:re(t),OfferToReceiveVideo:oe(t)}};p.debug(a);var b=ne(t);if(b&&o&&"firefox"===p.webRTCAdapter.browserDetails.browser){p.log("Enabling Simulcasting for Firefox (RID)");var S=i.pc.getSenders()[1];p.log(S);var w=S.getParameters();p.log(w);var k=C(r.simulcastMaxBitrates);S.setParameters({encodings:r.sendEncodings||[{rid:"h",active:!0,maxBitrate:k.high},{rid:"m",active:!0,maxBitrate:k.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:k.low,scaleResolutionDownBy:4}]})}i.pc.createAnswer(a).then((function(e){p.debug(e);var t={type:e.type,sdp:e.sdp};r.customizeSdp(t),e.sdp=t.sdp,p.log("Setting local description"),b&&o&&!p.unifiedPlan&&"chrome"===p.webRTCAdapter.browserDetails.browser&&p.warn("simulcast=true, but this is an answer, and video breaks in Chrome if we enable it"),i.mySdp={type:"answer",sdp:e.sdp},i.pc.setLocalDescription(e).catch(r.error),i.mediaConstraints=a,i.iceDone||i.trickle?((i.senderTransforms||i.receiverTransforms)&&(e["e2ee"]=!0),r.success(e)):p.log("Waiting for all candidates...")}),r.error)}function B(e,t){t=t||{},t.success="function"==typeof t.success?t.success:p.noop,t.error="function"==typeof t.error?t.error:p.noop;var r=T[e];if(r&&r.webrtcStuff){var n=r.webrtcStuff;p.log("Sending offer/answer SDP..."),n.mySdp?(n.mySdp={type:n.pc.localDescription.type,sdp:n.pc.localDescription.sdp},!1===n.trickle&&(n.mySdp["trickle"]=!1),p.debug(t),n.sdpSent=!0,t.success(n.mySdp)):p.warn("Local SDP instance is invalid, not sending anything...")}else p.warn("Invalid handle, not sending anything")}function W(e,t,r,n){n="function"==typeof n?n:p.noop;var i=T[e];if(!i||!i.webrtcStuff)return p.warn("Invalid handle"),void n(0);var o=r?"remote":"local",a=i.webrtcStuff;if(a.volume[o]||(a.volume[o]={value:0}),!a.pc.getStats||"chrome"!==p.webRTCAdapter.browserDetails.browser&&"safari"!==p.webRTCAdapter.browserDetails.browser)return p.warn("Getting the "+o+" volume unsupported by browser"),void n(0);if(r&&!a.remoteStream)return p.warn("Remote stream unavailable"),void n(0);if(!r&&!a.myStream)return p.warn("Local stream unavailable"),void n(0);var s=a.pc;if(t&&p.unifiedPlan){var c=a.pc.getTransceivers().find((function(e){return e.mid===t&&"audio"===e.receiver.track.kind}));if(!c)return p.warn("No audio transceiver with mid "+t),void n(0);if(r&&!c.receiver)return p.warn("Remote transceiver track unavailable"),void n(0);if(!r&&!c.sender)return p.warn("Local transceiver track unavailable"),void n(0);s=r?c.receiver:c.sender}return s.getStats().then((function(e){e.forEach((function(e){e&&"audio"===e.kind&&(r&&!e.remoteSource||!r&&"media-source"!==e.type||n(e.audioLevel?e.audioLevel:0))}))})),a.volume[o].value}function H(e,t,r){var n=T[e];if(!n||!n.webrtcStuff)return p.warn("Invalid handle"),!0;var i=n.webrtcStuff;if(!i.pc)return p.warn("Invalid PeerConnection"),!0;if(!i.myStream)return p.warn("Invalid local MediaStream"),!0;if(r){if(!i.myStream.getVideoTracks()||0===i.myStream.getVideoTracks().length)return p.warn("No video track"),!0;if(t&&p.unifiedPlan){var o=i.pc.getTransceivers().find((function(e){return e.mid===t&&"video"===e.receiver.track.kind}));return o?o.sender&&o.sender.track?!o.sender.track.enabled:(p.warn("No video sender with mid "+t),!0):(p.warn("No video transceiver with mid "+t),!0)}return!i.myStream.getVideoTracks()[0].enabled}if(!i.myStream.getAudioTracks()||0===i.myStream.getAudioTracks().length)return p.warn("No audio track"),!0;if(t&&p.unifiedPlan){var a=i.pc.getTransceivers().find((function(e){return e.mid===t&&"audio"===e.receiver.track.kind}));return a?a.sender&&a.sender.track?!a.sender.track.enabled:(p.warn("No audio sender with mid "+t),!0):(p.warn("No audio transceiver with mid "+t),!0)}return!i.myStream.getAudioTracks()[0].enabled}function K(e,t,r,n){var i=T[e];if(!i||!i.webrtcStuff)return p.warn("Invalid handle"),!1;var o=i.webrtcStuff;if(!o.pc)return p.warn("Invalid PeerConnection"),!1;if(!o.myStream)return p.warn("Invalid local MediaStream"),!1;if(r){if(!o.myStream.getVideoTracks()||0===o.myStream.getVideoTracks().length)return p.warn("No video track"),!1;if(t&&p.unifiedPlan){var a=o.pc.getTransceivers().find((function(e){return e.mid===t&&"video"===e.receiver.track.kind}));if(!a)return p.warn("No video transceiver with mid "+t),!1;if(!a.sender||!a.sender.track)return p.warn("No video sender with mid "+t),!1;a.sender.track.enabled=!n}else o.myStream.getVideoTracks()[0].enabled=!n}else{if(!o.myStream.getAudioTracks()||0===o.myStream.getAudioTracks().length)return p.warn("No audio track"),!1;if(t&&p.unifiedPlan){var s=o.pc.getTransceivers().find((function(e){return e.mid===t&&"audio"===e.receiver.track.kind}));if(!s)return p.warn("No audio transceiver with mid "+t),!1;if(!s.sender||!s.sender.track)return p.warn("No audio sender with mid "+t),!1;s.sender.track.enabled=!n}else o.myStream.getAudioTracks()[0].enabled=!n}return!0}function $(e,t){var r=T[e];if(!r||!r.webrtcStuff)return p.warn("Invalid handle"),"Invalid handle";var n=r.webrtcStuff;if(!n.pc)return"Invalid PeerConnection";if(n.pc.getStats){var i=n.pc,o=t||"default";if(t&&p.unifiedPlan){var a=n.pc.getTransceivers().find((function(e){return e.mid===t&&"video"===e.receiver.track.kind}));if(!a)return p.warn("No video transceiver with mid "+t),"No video transceiver with mid "+t;if(!a.receiver)return p.warn("No video receiver with mid "+t),"No video receiver with mid "+t;i=a.receiver}return n.bitrate[o]||(n.bitrate[o]={timer:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,value:"0 kbits/sec"}),n.bitrate[o].timer?n.bitrate[o].value:(p.log("Starting bitrate timer"+(t?" for mid "+t:"")+" (via getStats)"),n.bitrate[o].timer=setInterval((function(){i.getStats().then((function(e){e.forEach((function(e){if(e){var t=!1;if(("video"===e.mediaType||e.id.toLowerCase().indexOf("video")>-1)&&"inbound-rtp"===e.type&&e.id.indexOf("rtcp")<0?t=!0:"ssrc"!=e.type||!e.bytesReceived||"VP8"!==e.googCodecName&&""!==e.googCodecName||(t=!0),t)if(n.bitrate[o].bsnow=e.bytesReceived,n.bitrate[o].tsnow=e.timestamp,null===n.bitrate[o].bsbefore||null===n.bitrate[o].tsbefore)n.bitrate[o].bsbefore=n.bitrate[o].bsnow,n.bitrate[o].tsbefore=n.bitrate[o].tsnow;else{var r=n.bitrate[o].tsnow-n.bitrate[o].tsbefore;"safari"===p.webRTCAdapter.browserDetails.browser&&(r/=1e3);var i=Math.round(8*(n.bitrate[o].bsnow-n.bitrate[o].bsbefore)/r);"safari"===p.webRTCAdapter.browserDetails.browser&&(i=parseInt(i/1e3)),n.bitrate[o].value=i+" kbits/sec",n.bitrate[o].bsbefore=n.bitrate[o].bsnow,n.bitrate[o].tsbefore=n.bitrate[o].tsnow}}}))}))}),1e3),"0 kbits/sec")}return p.warn("Getting the video bitrate unsupported by browser"),"Feature unsupported by browser"}function Q(e){p.error("WebRTC error:",e)}function Y(e,n){p.log("Cleaning WebRTC stuff");var i=T[e];if(i){var o=i.webrtcStuff;if(o){if(!0===n){var a={janus:"hangup",transaction:p.randomString(12)};i.token&&(a["token"]=i.token),y&&(a["apisecret"]=y),p.debug("Sending hangup request (handle="+e+"):"),p.debug(a),t?(a["session_id"]=k,a["handle_id"]=e,r.send(JSON.stringify(a))):p.httpAPICall(s+"/"+k+"/"+e,{verb:"POST",withCredentials:h,body:a})}for(var c in o.remoteStream=null,o.volume&&(o.volume["local"]&&o.volume["local"].timer&&clearInterval(o.volume["local"].timer),o.volume["remote"]&&o.volume["remote"].timer&&clearInterval(o.volume["remote"].timer)),o.bitrate)o.bitrate[c].timer&&clearInterval(o.bitrate[c].timer);o.bitrate={},!o.streamExternal&&o.myStream&&(p.log("Stopping local stream tracks"),p.stopAllTracks(o.myStream)),o.streamExternal=!1,o.myStream=null;try{o.pc.close()}catch(d){}o.pc=null,o.candidates=null,o.mySdp=null,o.remoteSdp=null,o.iceDone=!1,o.dataChannel={},o.dtmfSender=null,o.senderTransforms=null,o.receiverTransforms=null}i.oncleanup()}}function X(e){for(var t=e.split("\r\n"),r=!1,n=[-1],i=[-1],o=null,a=null,s=null,c=null,d=-1,u=0;u<t.length;u++){var l=t[u].match(/m=(\w+) */);if(l){var f=l[1];if("video"===f){if(!(n[0]<0)){d=u;break}r=!0}else if(n[0]>-1){d=u;break}}else if(r){var v=t[u].match(/a=ssrc-group:SIM (\d+) (\d+) (\d+)/);if(v)return p.warn("The SDP already contains a SIM attribute, munging will be skipped"),e;var h=t[u].match(/a=ssrc-group:FID (\d+) (\d+)/);if(h)n[0]=h[1],i[0]=h[2],t.splice(u,1),u--;else{if(n[0]){var m=t[u].match("a=ssrc:"+n[0]+" cname:(.+)");if(m&&(o=m[1]),m=t[u].match("a=ssrc:"+n[0]+" msid:(.+)"),m&&(a=m[1]),m=t[u].match("a=ssrc:"+n[0]+" mslabel:(.+)"),m&&(s=m[1]),m=t[u].match("a=ssrc:"+n[0]+" label:(.+)"),m&&(c=m[1]),0===t[u].indexOf("a=ssrc:"+i[0])){t.splice(u,1),u--;continue}if(0===t[u].indexOf("a=ssrc:"+n[0])){t.splice(u,1),u--;continue}}0!=t[u].length||(t.splice(u,1),u--)}}}if(n[0]<0){d=-1,r=!1;for(var g=0;g<t.length;g++){var y=t[g].match(/m=(\w+) */);if(y){var b=y[1];if("video"===b){if(!(n[0]<0)){d=g;break}r=!0}else if(n[0]>-1){d=g;break}}else if(r){if(n[0]<0){var S=t[g].match(/a=ssrc:(\d+)/);if(S){n[0]=S[1],t.splice(g,1),g--;continue}}else{var C=t[g].match("a=ssrc:"+n[0]+" cname:(.+)");if(C&&(o=C[1]),C=t[g].match("a=ssrc:"+n[0]+" msid:(.+)"),C&&(a=C[1]),C=t[g].match("a=ssrc:"+n[0]+" mslabel:(.+)"),C&&(s=C[1]),C=t[g].match("a=ssrc:"+n[0]+" label:(.+)"),C&&(c=C[1]),0===t[g].indexOf("a=ssrc:"+i[0])){t.splice(g,1),g--;continue}if(0===t[g].indexOf("a=ssrc:"+n[0])){t.splice(g,1),g--;continue}}0!==t[g].length||(t.splice(g,1),g--)}}}if(n[0]<0)return p.warn("Couldn't find the video SSRC, simulcasting NOT enabled"),e;d<0&&(d=t.length),n[1]=Math.floor(4294967295*Math.random()),n[2]=Math.floor(4294967295*Math.random()),i[1]=Math.floor(4294967295*Math.random()),i[2]=Math.floor(4294967295*Math.random());for(var w=0;w<n.length;w++)o&&(t.splice(d,0,"a=ssrc:"+n[w]+" cname:"+o),d++),a&&(t.splice(d,0,"a=ssrc:"+n[w]+" msid:"+a),d++),s&&(t.splice(d,0,"a=ssrc:"+n[w]+" mslabel:"+s),d++),c&&(t.splice(d,0,"a=ssrc:"+n[w]+" label:"+c),d++),o&&(t.splice(d,0,"a=ssrc:"+i[w]+" cname:"+o),d++),a&&(t.splice(d,0,"a=ssrc:"+i[w]+" msid:"+a),d++),s&&(t.splice(d,0,"a=ssrc:"+i[w]+" mslabel:"+s),d++),c&&(t.splice(d,0,"a=ssrc:"+i[w]+" label:"+c),d++);return t.splice(d,0,"a=ssrc-group:FID "+n[2]+" "+i[2]),t.splice(d,0,"a=ssrc-group:FID "+n[1]+" "+i[1]),t.splice(d,0,"a=ssrc-group:FID "+n[0]+" "+i[0]),t.splice(d,0,"a=ssrc-group:SIM "+n[0]+" "+n[1]+" "+n[2]),e=t.join("\r\n"),e.endsWith("\r\n")||(e+="\r\n"),e}function ee(e){return p.debug("isAudioSendEnabled:",e),!e||!1!==e.audio&&(void 0===e.audioSend||null===e.audioSend||!0===e.audioSend)}function te(e){return p.debug("isAudioSendRequired:",e),!!e&&(!1!==e.audio&&!1!==e.audioSend&&(void 0!==e.failIfNoAudio&&null!==e.failIfNoAudio&&!0===e.failIfNoAudio))}function re(e){return p.debug("isAudioRecvEnabled:",e),!e||!1!==e.audio&&(void 0===e.audioRecv||null===e.audioRecv||!0===e.audioRecv)}function ne(e){return p.debug("isVideoSendEnabled:",e),!e||!1!==e.video&&(void 0===e.videoSend||null===e.videoSend||!0===e.videoSend)}function ie(e){return p.debug("isVideoSendRequired:",e),!!e&&(!1!==e.video&&!1!==e.videoSend&&(void 0!==e.failIfNoVideo&&null!==e.failIfNoVideo&&!0===e.failIfNoVideo))}function oe(e){return p.debug("isVideoRecvEnabled:",e),!e||!1!==e.video&&(void 0===e.videoRecv||null===e.videoRecv||!0===e.videoRecv)}function ae(e){if(p.debug("isScreenSendEnabled:",e),!e)return!1;if("object"!==(0,d.Z)(e.video)||"object"!==(0,d.Z)(e.video.mandatory))return!1;var t=e.video.mandatory;return t.chromeMediaSource?"desktop"===t.chromeMediaSource||"screen"===t.chromeMediaSource:t.mozMediaSource?"window"===t.mozMediaSource||"screen"===t.mozMediaSource:!!t.mediaSource&&("window"===t.mediaSource||"screen"===t.mediaSource)}function se(e){return p.debug("isDataEnabled:",e),"edge"===p.webRTCAdapter.browserDetails.browser?(p.warn("Edge doesn't support data channels yet"),!1):void 0!==e&&null!==e&&!0===e.data}function ce(e){return p.debug("isTrickleEnabled:",e),!1!==e}I(e),this.getServer=function(){return s},this.isConnected=function(){return w},this.reconnect=function(e){e=e||{},e.success="function"==typeof e.success?e.success:p.noop,e.error="function"==typeof e.error?e.error:p.noop,e["reconnect"]=!0,I(e)},this.getSessionId=function(){return k},this.getInfo=function(e){_(e)},this.destroy=function(e){M(e)},this.attach=function(e){O(e)}}p.useDefaultDependencies=function(e){var t=e&&e.fetch||fetch,r=e&&e.Promise||Promise,n=e&&e.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new n(e,t)},extension:e&&e.extension||l,isArray:function(e){return Array.isArray(e)},webRTCAdapter:e&&e.adapter||u,httpAPICall:function(e,n){var i={method:n.verb,headers:{Accept:"application/json, text/plain, */*"},cache:"no-cache"};"POST"===n.verb&&(i.headers["Content-Type"]="application/json"),void 0!==n.withCredentials&&(i.credentials=!0===n.withCredentials?"include":n.withCredentials?n.withCredentials:"omit"),n.body&&(i.body=JSON.stringify(n.body));var o=t(e,i).catch((function(e){return r.reject({message:"Probably a network error, is the server down?",error:e})}));if(n.timeout){var a=new r((function(e,t){var r=setTimeout((function(){return clearTimeout(r),t({message:"Request timed out",timeout:n.timeout})}),n.timeout)}));o=r.race([o,a])}return o.then((function(e){return e.ok?(0,d.Z)(n.success)===(0,d.Z)(p.noop)?e.json().then((function(e){try{n.success(e)}catch(t){p.error("Unhandled httpAPICall success callback error",t)}}),(function(t){return r.reject({message:"Failed to parse response body",error:t,response:e})})):void 0:r.reject({message:"API call failed",response:e})})).catch((function(e){(0,d.Z)(n.error)===(0,d.Z)(p.noop)&&n.error(e.message||"<< internal error >>",e)})),o}}},p.useOldDependencies=function(e){var t=e&&e.jQuery||jQuery,r=e&&e.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new r(e,t)},isArray:function(e){return t.isArray(e)},extension:e&&e.extension||l,webRTCAdapter:e&&e.adapter||u,httpAPICall:function(e,r){var n=void 0!==r.body?{contentType:"application/json",data:JSON.stringify(r.body)}:{},i=void 0!==r.withCredentials?{xhrFields:{withCredentials:r.withCredentials}}:{};return t.ajax(t.extend(n,i,{url:e,type:r.verb,cache:!1,dataType:"json",async:r.async,timeout:r.timeout,success:function(e){(0,d.Z)(r.success)===(0,d.Z)(p.noop)&&r.success(e)},error:function(e,t,n){(0,d.Z)(r.error)===(0,d.Z)(p.noop)&&r.error(t,n)}}))}}},p.noop=function(){},p.dataChanDefaultLabel="JanusDataChannel",p.endOfCandidates=null,p.stopAllTracks=function(e){try{var t,r=e.getTracks(),n=(0,c.Z)(r);try{for(n.s();!(t=n.n()).done;){var i=t.value;p.log(i),i&&i.stop()}}catch(o){n.e(o)}finally{n.f()}}catch(a){}},p.init=function(e){if(e=e||{},e.callback="function"==typeof e.callback?e.callback:p.noop,p.initDone)e.callback();else{if("undefined"==typeof console.log&&(console.log=function(){}),p.trace=p.noop,p.debug=p.noop,p.vdebug=p.noop,p.log=p.noop,p.warn=p.noop,p.error=p.noop,!0===e.debug||"all"===e.debug)p.trace=console.trace.bind(console),p.debug=console.debug.bind(console),p.vdebug=console.debug.bind(console),p.log=console.log.bind(console),p.warn=console.warn.bind(console),p.error=console.error.bind(console);else if(Array.isArray(e.debug)){var t,r=(0,c.Z)(e.debug);try{for(r.s();!(t=r.n()).done;){var n=t.value;switch(n){case"trace":p.trace=console.trace.bind(console);break;case"debug":p.debug=console.debug.bind(console);break;case"vdebug":p.vdebug=console.debug.bind(console);break;case"log":p.log=console.log.bind(console);break;case"warn":p.warn=console.warn.bind(console);break;case"error":p.error=console.error.bind(console);break;default:console.error("Unknown debugging option '"+n+"' (supported: 'trace', 'debug', 'vdebug', 'log', warn', 'error')");break}}}catch(h){r.e(h)}finally{r.f()}}p.log("Initializing library");var i=e.dependencies||p.useDefaultDependencies();p.isArray=i.isArray,p.webRTCAdapter=i.webRTCAdapter,p.httpAPICall=i.httpAPICall,p.newWebSocket=i.newWebSocket,p.extension=i.extension,p.extension.init(),p.listDevices=function(e,t){e="function"==typeof e?e:p.noop,null==t&&(t={audio:!0,video:!0}),p.isGetUserMediaAvailable()?navigator.mediaDevices.getUserMedia(t).then((function(t){navigator.mediaDevices.enumerateDevices().then((function(r){p.debug(r),e(r),p.stopAllTracks(t)}))})).catch((function(t){p.error(t),e([])})):(p.warn("navigator.mediaDevices unavailable"),e([]))},p.attachMediaStream=function(e,t){try{e.srcObject=t}catch(r){try{e.src=URL.createObjectURL(t)}catch(r){p.error("Error attaching stream to element")}}},p.reattachMediaStream=function(e,t){try{e.srcObject=t.srcObject}catch(r){try{e.src=t.src}catch(r){p.error("Error reattaching stream to element")}}};var o=["iPad","iPhone","iPod"].indexOf(navigator.platform)>=0,a=o?"pagehide":"beforeunload",s=window["on"+a];if(window.addEventListener(a,(function(){for(var e in p.log("Closing window"),p.sessions)p.sessions[e]&&p.sessions[e].destroyOnUnload&&(p.log("Destroying session "+e),p.sessions[e].destroy({unload:!0,notifyDestroyed:!1}));s&&"function"==typeof s&&s()})),p.safariVp8=!1,"safari"===p.webRTCAdapter.browserDetails.browser&&p.webRTCAdapter.browserDetails.version>=605)if(RTCRtpSender&&RTCRtpSender.getCapabilities&&RTCRtpSender.getCapabilities("video")&&RTCRtpSender.getCapabilities("video").codecs&&RTCRtpSender.getCapabilities("video").codecs.length){var d,u=(0,c.Z)(RTCRtpSender.getCapabilities("video").codecs);try{for(u.s();!(d=u.n()).done;){var l=d.value;if(l&&l.mimeType&&"video/vp8"===l.mimeType.toLowerCase()){p.safariVp8=!0;break}}}catch(h){u.e(h)}finally{u.f()}p.safariVp8?p.log("This version of Safari supports VP8"):p.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu")}else{var f=new RTCPeerConnection({});f.createOffer({offerToReceiveVideo:!0}).then((function(e){p.safariVp8=-1!==e.sdp.indexOf("VP8"),p.safariVp8?p.log("This version of Safari supports VP8"):p.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu"),f.close(),f=null}))}if(p.unifiedPlan=!1,"firefox"===p.webRTCAdapter.browserDetails.browser&&p.webRTCAdapter.browserDetails.version>=59)p.unifiedPlan=!0;else if("chrome"===p.webRTCAdapter.browserDetails.browser&&p.webRTCAdapter.browserDetails.version>=72)p.unifiedPlan=!0;else if(window.RTCRtpTransceiver&&"currentDirection"in RTCRtpTransceiver.prototype){var v=new RTCPeerConnection;try{v.addTransceiver("audio"),p.unifiedPlan=!0}catch(m){}v.close()}else p.unifiedPlan=!1;p.initDone=!0,e.callback()}},p.isWebrtcSupported=function(){return!!window.RTCPeerConnection},p.isGetUserMediaAvailable=function(){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia},p.randomString=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r="",n=0;n<e;n++){var i=Math.floor(Math.random()*t.length);r+=t.substring(i,i+1)}return r};var f=r(3477),v=14.875811571268388,h=102.01502828868293,m=14.875811571268388,g=102.01502828868293,y="https://i.postimg.cc/3N0bcm0F/Picture-Car.png",b="https://i.postimg.cc/bNC9tsGz/icons8-iphone-se-80.png",S="https://34.143.225.243:8089/janus";"http:"===window.location.protocol&&(S="http://34.143.225.243:8088/janus",console.log(S));var C={name:"App",data:function(){return{janus:null,error:null,plugin:null,status:null,stream:null,streamList:{selected:null,options:[]},remoteTracks:{},remoteVideos:0,iconCar:y,iconUser:b,latitude:0,longitude:0,center:{lat:0,lng:0},locations:[],currentLocation:null,selectedKey:null,selectedMarker:null,coordinates:{0:{lat:v.toString(),lng:h.toString()},1:{lat:m.toString(),lng:g.toString()}}}},computed:{aDouble:function(){return this.center}},mounted:function(){var e=this;this.setLocationLatLng(),this.dbRef.on("value",(function(t){for(var r=0,n=Object.entries(t.val());r<n.length;r++){var i=(0,s.Z)(n[r],2),o=i[0],a=i[1];"latitude"==o&&(e.latitude=a,console.log("".concat(o,": ").concat(a)),v=a),"longitude"==o&&(e.longitude=a,console.log("".concat(o,": ").concat(a)),h=a),e.center={lat:(v+m)/2,lng:(h+g)/2},e.coordinates={0:{lat:v.toString(),lng:h.toString()},1:{lat:m.toString(),lng:g.toString()}}}})),this.dbRef1.on("value",(function(t){console.log(t.val());for(var r=0,n=Object.entries(t.val());r<n.length;r++){var i=(0,s.Z)(n[r],2),o=i[0],a=i[1];"latitude"==o&&(e.latitude=a,console.log("".concat(o,": ").concat(a)),m=a),"longitude"==o&&(e.longitude=a,console.log("".concat(o,": ").concat(a)),g=a),e.center={lat:(v+m)/2,lng:(h+g)/2},e.coordinates={0:{lat:v.toString(),lng:h.toString()},1:{lat:m.toString(),lng:g.toString()}}}})),p.init({debug:!0,dependencies:p.useDefaultDependencies(),callback:function(){console.log("Connecting to Janus api with server ",S),e.connect(S)}})},methods:{getMarkers:function(e){return this.selectedKey===e?this.mapMarkerActive:this.mapMarker},getMarkers1:function(e){return console.log(e),0==e?this.iconCar:1==e?this.iconUser:void 0},getPosition:function(e){return{lat:parseFloat(e.lat),lng:parseFloat(e.lng)}},toggleInfo:function(e,t){this.infoPosition=this.getPosition(e),this.selectedMarker=e,this.selectedKey=t,this.infoOpened=!this.infoOpened},closeInfoWindow:function(){this.infoOpened=!1,this.markerOptions=this.mapMarker},setPlace:function(e){this.currentLocation=e},setLocationLatLng:function(){var e=this;navigator.geolocation.getCurrentPosition((function(t){e.center={lat:t.coords.latitude,lng:t.coords.longitude}}))},connect:function(e){var t=this;this.janus=new p({server:e,success:function(){console.log("Connected"),t.attachPlugin()},error:function(e){console.log("Error"),t.onError("Failed to connect janus server",e)},destroyed:function(){console.log("Destroyed"),window.location.reload()}})},attachPlugin:function(){var e=this;this.janus.attach({plugin:"janus.plugin.streaming",opaqueId:"thisisopaqueid",success:function(t){e.plugin=t,console.log("getBitrate : ",e.plugin.getBitrate()),e.updateStreamsList()},error:function(t){e.onError("Error attaching plugin... ",t)},iceState:function(e){console.log("ICE state changed to ",e)},webrtcState:function(e){console.log("Janus says our WebRTC PeerConnection is "+(e?"up":"down")+" now")},slowLink:function(e,t,r){console.log("Janus reports problems "+(e?"sending":"receiving")+" packets on mid "+r+" ("+t+" lost packets)")},onmessage:function(t,r){console.log(" ::: Got a message :::",t);var n=t.result;if(n)n.status&&(e.status=n.status);else if(t.error)return e.onError(t.error),void e.stop();if(r){p.debug("Handling SDP as Well... ",r);var i=-1!==r.sdp.indexOf("stereo=1");e.plugin.createAnswer({jsep:r,media:{audioSend:!1,videoSend:!1,data:!0},customizeSdp:function(e){i&&-1==e.sdp.indexOf("stereo=1")&&(e.sdp=e.sdp.replace("useinbandfec=1","useinbandfec=1;stereo=1"))},success:function(t){p.debug("Got SDP!",t);var r={request:"start"};e.plugin.send({message:r,jsep:t})},error:function(t){e.onError("WebRTC Error: ",t),alert("WebRTC error... ",t)}})}},onremotetrack:function(t,r,n){p.debug("Remote track (mid="+r+") "+(n?"added":"removed")+":",t),"video"===t.kind&&(e.remoteVideos++,e.stream=new MediaStream,e.stream.addTrack(t.clone()),e.remoteTracks.mid=e.stream,p.log("Created remote audio stream:",e.stream))},oncleanup:function(){e.onCleanup()}})},updateStreamsList:function(){var e=this;this.plugin.send({message:{request:"list"},success:function(t){t||e.onError("Got no response to our query for available streams."),console.log("Updating StreamList....",t),e.streamList.options=t.list,t.list.length&&(e.streamList.selected=e.streamList.options[0].id)}})},start:function(){this.plugin.send({message:{request:"watch",id:this.streamList.selected}})},stop:function(){this.plugin.send({message:{request:"stop"}}),this.plugin.hangup()},onCleanup:function(){p.log(" ::: Got a cleanup notification :::"),this.stream=null,this.status=null,this.remoteTracks={},this.remoteVideos=0,this.error=null},onError:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";p.error(e,t),this.error=e+t,alert(this.error,(function(){window.location.reload()}))}},created:function(){this.dbRef=f.Z.database().ref("locationCar"),this.dbRef1=f.Z.database().ref("location")},beforeDestroy:function(){this.dbRef.off()}},w=C,k=r(1001),T=(0,k.Z)(w,o,a,!1,null,"54c0b050",null),R=T.exports,P={name:"StreamingView",components:{Streaming:R}},D=P,A=(0,k.Z)(D,n,i,!1,null,null,null),E=A.exports},590:function(e,t,r){var n=r(7293),i=r(5112),o=r(1913),a=i("iterator");e.exports=!n((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r="";return e.pathname="c%20d",t.forEach((function(e,n){t["delete"]("b"),r+=n+e})),o&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[a]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://").host||"#%D0%B1"!==new URL("http://a#").hash||"a1c3"!==r||"x"!==new URL("http://x",void 0).host}))},3197:function(e,t,r){"use strict";var n=r(7854),i=r(1702),o=2147483647,a=36,s=1,c=26,d=38,u=700,l=72,p=128,f="-",v=/[^\0-\u007E]/,h=/[.\u3002\uFF0E\uFF61]/g,m="Overflow: input needs wider integers to process",g=a-s,y=n.RangeError,b=i(h.exec),S=Math.floor,C=String.fromCharCode,w=i("".charCodeAt),k=i([].join),T=i([].push),R=i("".replace),P=i("".split),D=i("".toLowerCase),A=function(e){var t=[],r=0,n=e.length;while(r<n){var i=w(e,r++);if(i>=55296&&i<=56319&&r<n){var o=w(e,r++);56320==(64512&o)?T(t,((1023&i)<<10)+(1023&o)+65536):(T(t,i),r--)}else T(t,i)}return t},E=function(e){return e+22+75*(e<26)},x=function(e,t,r){var n=0;e=r?S(e/u):e>>1,e+=S(e/t);while(e>g*c>>1)e=S(e/g),n+=a;return S(n+(g+1)*e/(e+d))},I=function(e){var t=[];e=A(e);var r,n,i=e.length,d=p,u=0,v=l;for(r=0;r<e.length;r++)n=e[r],n<128&&T(t,C(n));var h=t.length,g=h;h&&T(t,f);while(g<i){var b=o;for(r=0;r<e.length;r++)n=e[r],n>=d&&n<b&&(b=n);var w=g+1;if(b-d>S((o-u)/w))throw y(m);for(u+=(b-d)*w,d=b,r=0;r<e.length;r++){if(n=e[r],n<d&&++u>o)throw y(m);if(n==d){var R=u,P=a;while(1){var D=P<=v?s:P>=v+c?c:P-v;if(R<D)break;var I=R-D,_=a-D;T(t,C(E(D+I%_))),R=S(I/_),P+=a}T(t,C(E(R))),v=x(u,w,g==h),u=0,g++}}u++,d++}return k(t,"")};e.exports=function(e){var t,r,n=[],i=P(R(D(e),h,"."),".");for(t=0;t<i.length;t++)r=i[t],T(n,b(v,r)?"xn--"+I(r):r);return k(n,".")}},7852:function(e,t,r){"use strict";var n=r(2109),i=r(1702),o=r(1236).f,a=r(7466),s=r(1340),c=r(3929),d=r(4488),u=r(4964),l=r(1913),p=i("".endsWith),f=i("".slice),v=Math.min,h=u("endsWith"),m=!l&&!h&&!!function(){var e=o(String.prototype,"endsWith");return e&&!e.writable}();n({target:"String",proto:!0,forced:!m&&!h},{endsWith:function(e){var t=s(d(this));c(e);var r=arguments.length>1?arguments[1]:void 0,n=t.length,i=void 0===r?n:v(a(r),n),o=s(e);return p?p(t,o,i):f(t,i-o.length,i)===o}})},5556:function(e,t,r){"use strict";r(6992);var n=r(2109),i=r(7854),o=r(6916),a=r(1702),s=r(9781),c=r(590),d=r(1320),u=r(2248),l=r(8003),p=r(4994),f=r(9909),v=r(5787),h=r(614),m=r(2597),g=r(9974),y=r(648),b=r(9670),S=r(111),C=r(1340),w=r(30),k=r(9114),T=r(8554),R=r(1246),P=r(8053),D=r(5112),A=r(4362),E=D("iterator"),x="URLSearchParams",I=x+"Iterator",_=f.set,M=f.getterFor(x),O=f.getterFor(I),L=Object.getOwnPropertyDescriptor,j=function(e){if(!s)return i[e];var t=L(i,e);return t&&t.value},U=j("fetch"),V=j("Request"),N=j("Headers"),F=V&&V.prototype,Z=N&&N.prototype,z=i.RegExp,J=i.TypeError,G=i.decodeURIComponent,q=i.encodeURIComponent,B=a("".charAt),W=a([].join),H=a([].push),K=a("".replace),$=a([].shift),Q=a([].splice),Y=a("".split),X=a("".slice),ee=/\+/g,te=Array(4),re=function(e){return te[e-1]||(te[e-1]=z("((?:%[\\da-f]{2}){"+e+"})","gi"))},ne=function(e){try{return G(e)}catch(t){return e}},ie=function(e){var t=K(e,ee," "),r=4;try{return G(t)}catch(n){while(r)t=K(t,re(r--),ne);return t}},oe=/[!'()~]|%20/g,ae={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},se=function(e){return ae[e]},ce=function(e){return K(q(e),oe,se)},de=p((function(e,t){_(this,{type:I,iterator:T(M(e).entries),kind:t})}),"Iterator",(function(){var e=O(this),t=e.kind,r=e.iterator.next(),n=r.value;return r.done||(r.value="keys"===t?n.key:"values"===t?n.value:[n.key,n.value]),r}),!0),ue=function(e){this.entries=[],this.url=null,void 0!==e&&(S(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===B(e,0)?X(e,1):e:C(e)))};ue.prototype={type:x,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,r,n,i,a,s,c,d=R(e);if(d){t=T(e,d),r=t.next;while(!(n=o(r,t)).done){if(i=T(b(n.value)),a=i.next,(s=o(a,i)).done||(c=o(a,i)).done||!o(a,i).done)throw J("Expected sequence with length 2");H(this.entries,{key:C(s.value),value:C(c.value)})}}else for(var u in e)m(e,u)&&H(this.entries,{key:u,value:C(e[u])})},parseQuery:function(e){if(e){var t,r,n=Y(e,"&"),i=0;while(i<n.length)t=n[i++],t.length&&(r=Y(t,"="),H(this.entries,{key:ie($(r)),value:ie(W(r,"="))}))}},serialize:function(){var e,t=this.entries,r=[],n=0;while(n<t.length)e=t[n++],H(r,ce(e.key)+"="+ce(e.value));return W(r,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var le=function(){v(this,pe);var e=arguments.length>0?arguments[0]:void 0;_(this,new ue(e))},pe=le.prototype;if(u(pe,{append:function(e,t){P(arguments.length,2);var r=M(this);H(r.entries,{key:C(e),value:C(t)}),r.updateURL()},delete:function(e){P(arguments.length,1);var t=M(this),r=t.entries,n=C(e),i=0;while(i<r.length)r[i].key===n?Q(r,i,1):i++;t.updateURL()},get:function(e){P(arguments.length,1);for(var t=M(this).entries,r=C(e),n=0;n<t.length;n++)if(t[n].key===r)return t[n].value;return null},getAll:function(e){P(arguments.length,1);for(var t=M(this).entries,r=C(e),n=[],i=0;i<t.length;i++)t[i].key===r&&H(n,t[i].value);return n},has:function(e){P(arguments.length,1);var t=M(this).entries,r=C(e),n=0;while(n<t.length)if(t[n++].key===r)return!0;return!1},set:function(e,t){P(arguments.length,1);for(var r,n=M(this),i=n.entries,o=!1,a=C(e),s=C(t),c=0;c<i.length;c++)r=i[c],r.key===a&&(o?Q(i,c--,1):(o=!0,r.value=s));o||H(i,{key:a,value:s}),n.updateURL()},sort:function(){var e=M(this);A(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){var t,r=M(this).entries,n=g(e,arguments.length>1?arguments[1]:void 0),i=0;while(i<r.length)t=r[i++],n(t.value,t.key,this)},keys:function(){return new de(this,"keys")},values:function(){return new de(this,"values")},entries:function(){return new de(this,"entries")}},{enumerable:!0}),d(pe,E,pe.entries,{name:"entries"}),d(pe,"toString",(function(){return M(this).serialize()}),{enumerable:!0}),l(le,x),n({global:!0,forced:!c},{URLSearchParams:le}),!c&&h(N)){var fe=a(Z.has),ve=a(Z.set),he=function(e){if(S(e)){var t,r=e.body;if(y(r)===x)return t=e.headers?new N(e.headers):new N,fe(t,"content-type")||ve(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),w(e,{body:k(0,C(r)),headers:k(0,t)})}return e};if(h(U)&&n({global:!0,enumerable:!0,noTargetGet:!0,forced:!0},{fetch:function(e){return U(e,arguments.length>1?he(arguments[1]):{})}}),h(V)){var me=function(e){return v(this,F),new V(e,arguments.length>1?he(arguments[1]):{})};F.constructor=me,me.prototype=F,n({global:!0,forced:!0,noTargetGet:!0},{Request:me})}}e.exports={URLSearchParams:le,getState:M}},1637:function(e,t,r){r(5556)},8789:function(e,t,r){"use strict";r(8783);var n,i=r(2109),o=r(9781),a=r(590),s=r(7854),c=r(9974),d=r(1702),u=r(6048).f,l=r(1320),p=r(5787),f=r(2597),v=r(1574),h=r(8457),m=r(1589),g=r(8710).codeAt,y=r(3197),b=r(1340),S=r(8003),C=r(8053),w=r(5556),k=r(9909),T=k.set,R=k.getterFor("URL"),P=w.URLSearchParams,D=w.getState,A=s.URL,E=s.TypeError,x=s.parseInt,I=Math.floor,_=Math.pow,M=d("".charAt),O=d(/./.exec),L=d([].join),j=d(1..toString),U=d([].pop),V=d([].push),N=d("".replace),F=d([].shift),Z=d("".split),z=d("".slice),J=d("".toLowerCase),G=d([].unshift),q="Invalid authority",B="Invalid scheme",W="Invalid host",H="Invalid port",K=/[a-z]/i,$=/[\d+-.a-z]/i,Q=/\d/,Y=/^0x/i,X=/^[0-7]+$/,ee=/^\d+$/,te=/^[\da-f]+$/i,re=/[\0\t\n\r #%/:<>?@[\\\]^|]/,ne=/[\0\t\n\r #/:<>?@[\\\]^|]/,ie=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,oe=/[\t\n\r]/g,ae=function(e){var t,r,n,i,o,a,s,c=Z(e,".");if(c.length&&""==c[c.length-1]&&c.length--,t=c.length,t>4)return e;for(r=[],n=0;n<t;n++){if(i=c[n],""==i)return e;if(o=10,i.length>1&&"0"==M(i,0)&&(o=O(Y,i)?16:8,i=z(i,8==o?1:2)),""===i)a=0;else{if(!O(10==o?ee:8==o?X:te,i))return e;a=x(i,o)}V(r,a)}for(n=0;n<t;n++)if(a=r[n],n==t-1){if(a>=_(256,5-t))return null}else if(a>255)return null;for(s=U(r),n=0;n<r.length;n++)s+=r[n]*_(256,3-n);return s},se=function(e){var t,r,n,i,o,a,s,c=[0,0,0,0,0,0,0,0],d=0,u=null,l=0,p=function(){return M(e,l)};if(":"==p()){if(":"!=M(e,1))return;l+=2,d++,u=d}while(p()){if(8==d)return;if(":"!=p()){t=r=0;while(r<4&&O(te,p()))t=16*t+x(p(),16),l++,r++;if("."==p()){if(0==r)return;if(l-=r,d>6)return;n=0;while(p()){if(i=null,n>0){if(!("."==p()&&n<4))return;l++}if(!O(Q,p()))return;while(O(Q,p())){if(o=x(p(),10),null===i)i=o;else{if(0==i)return;i=10*i+o}if(i>255)return;l++}c[d]=256*c[d]+i,n++,2!=n&&4!=n||d++}if(4!=n)return;break}if(":"==p()){if(l++,!p())return}else if(p())return;c[d++]=t}else{if(null!==u)return;l++,d++,u=d}}if(null!==u){a=d-u,d=7;while(0!=d&&a>0)s=c[d],c[d--]=c[u+a-1],c[u+--a]=s}else if(8!=d)return;return c},ce=function(e){for(var t=null,r=1,n=null,i=0,o=0;o<8;o++)0!==e[o]?(i>r&&(t=n,r=i),n=null,i=0):(null===n&&(n=o),++i);return i>r&&(t=n,r=i),t},de=function(e){var t,r,n,i;if("number"==typeof e){for(t=[],r=0;r<4;r++)G(t,e%256),e=I(e/256);return L(t,".")}if("object"==typeof e){for(t="",n=ce(e),r=0;r<8;r++)i&&0===e[r]||(i&&(i=!1),n===r?(t+=r?":":"::",i=!0):(t+=j(e[r],16),r<7&&(t+=":")));return"["+t+"]"}return e},ue={},le=v({},ue,{" ":1,'"':1,"<":1,">":1,"`":1}),pe=v({},le,{"#":1,"?":1,"{":1,"}":1}),fe=v({},pe,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),ve=function(e,t){var r=g(e,0);return r>32&&r<127&&!f(t,e)?e:encodeURIComponent(e)},he={ftp:21,file:null,http:80,https:443,ws:80,wss:443},me=function(e,t){var r;return 2==e.length&&O(K,M(e,0))&&(":"==(r=M(e,1))||!t&&"|"==r)},ge=function(e){var t;return e.length>1&&me(z(e,0,2))&&(2==e.length||"/"===(t=M(e,2))||"\\"===t||"?"===t||"#"===t)},ye=function(e){return"."===e||"%2e"===J(e)},be=function(e){return e=J(e),".."===e||"%2e."===e||".%2e"===e||"%2e%2e"===e},Se={},Ce={},we={},ke={},Te={},Re={},Pe={},De={},Ae={},Ee={},xe={},Ie={},_e={},Me={},Oe={},Le={},je={},Ue={},Ve={},Ne={},Fe={},Ze=function(e,t,r){var n,i,o,a=b(e);if(t){if(i=this.parse(a),i)throw E(i);this.searchParams=null}else{if(void 0!==r&&(n=new Ze(r,!0)),i=this.parse(a,null,n),i)throw E(i);o=D(new P),o.bindURL(this),this.searchParams=o}};Ze.prototype={type:"URL",parse:function(e,t,r){var i,o,a,s,c=this,d=t||Se,u=0,l="",p=!1,v=!1,g=!1;e=b(e),t||(c.scheme="",c.username="",c.password="",c.host=null,c.port=null,c.path=[],c.query=null,c.fragment=null,c.cannotBeABaseURL=!1,e=N(e,ie,"")),e=N(e,oe,""),i=h(e);while(u<=i.length){switch(o=i[u],d){case Se:if(!o||!O(K,o)){if(t)return B;d=we;continue}l+=J(o),d=Ce;break;case Ce:if(o&&(O($,o)||"+"==o||"-"==o||"."==o))l+=J(o);else{if(":"!=o){if(t)return B;l="",d=we,u=0;continue}if(t&&(c.isSpecial()!=f(he,l)||"file"==l&&(c.includesCredentials()||null!==c.port)||"file"==c.scheme&&!c.host))return;if(c.scheme=l,t)return void(c.isSpecial()&&he[c.scheme]==c.port&&(c.port=null));l="","file"==c.scheme?d=Me:c.isSpecial()&&r&&r.scheme==c.scheme?d=ke:c.isSpecial()?d=De:"/"==i[u+1]?(d=Te,u++):(c.cannotBeABaseURL=!0,V(c.path,""),d=Ve)}break;case we:if(!r||r.cannotBeABaseURL&&"#"!=o)return B;if(r.cannotBeABaseURL&&"#"==o){c.scheme=r.scheme,c.path=m(r.path),c.query=r.query,c.fragment="",c.cannotBeABaseURL=!0,d=Fe;break}d="file"==r.scheme?Me:Re;continue;case ke:if("/"!=o||"/"!=i[u+1]){d=Re;continue}d=Ae,u++;break;case Te:if("/"==o){d=Ee;break}d=Ue;continue;case Re:if(c.scheme=r.scheme,o==n)c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,c.path=m(r.path),c.query=r.query;else if("/"==o||"\\"==o&&c.isSpecial())d=Pe;else if("?"==o)c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,c.path=m(r.path),c.query="",d=Ne;else{if("#"!=o){c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,c.path=m(r.path),c.path.length--,d=Ue;continue}c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,c.path=m(r.path),c.query=r.query,c.fragment="",d=Fe}break;case Pe:if(!c.isSpecial()||"/"!=o&&"\\"!=o){if("/"!=o){c.username=r.username,c.password=r.password,c.host=r.host,c.port=r.port,d=Ue;continue}d=Ee}else d=Ae;break;case De:if(d=Ae,"/"!=o||"/"!=M(l,u+1))continue;u++;break;case Ae:if("/"!=o&&"\\"!=o){d=Ee;continue}break;case Ee:if("@"==o){p&&(l="%40"+l),p=!0,a=h(l);for(var y=0;y<a.length;y++){var S=a[y];if(":"!=S||g){var C=ve(S,fe);g?c.password+=C:c.username+=C}else g=!0}l=""}else if(o==n||"/"==o||"?"==o||"#"==o||"\\"==o&&c.isSpecial()){if(p&&""==l)return q;u-=h(l).length+1,l="",d=xe}else l+=o;break;case xe:case Ie:if(t&&"file"==c.scheme){d=Le;continue}if(":"!=o||v){if(o==n||"/"==o||"?"==o||"#"==o||"\\"==o&&c.isSpecial()){if(c.isSpecial()&&""==l)return W;if(t&&""==l&&(c.includesCredentials()||null!==c.port))return;if(s=c.parseHost(l),s)return s;if(l="",d=je,t)return;continue}"["==o?v=!0:"]"==o&&(v=!1),l+=o}else{if(""==l)return W;if(s=c.parseHost(l),s)return s;if(l="",d=_e,t==Ie)return}break;case _e:if(!O(Q,o)){if(o==n||"/"==o||"?"==o||"#"==o||"\\"==o&&c.isSpecial()||t){if(""!=l){var w=x(l,10);if(w>65535)return H;c.port=c.isSpecial()&&w===he[c.scheme]?null:w,l=""}if(t)return;d=je;continue}return H}l+=o;break;case Me:if(c.scheme="file","/"==o||"\\"==o)d=Oe;else{if(!r||"file"!=r.scheme){d=Ue;continue}if(o==n)c.host=r.host,c.path=m(r.path),c.query=r.query;else if("?"==o)c.host=r.host,c.path=m(r.path),c.query="",d=Ne;else{if("#"!=o){ge(L(m(i,u),""))||(c.host=r.host,c.path=m(r.path),c.shortenPath()),d=Ue;continue}c.host=r.host,c.path=m(r.path),c.query=r.query,c.fragment="",d=Fe}}break;case Oe:if("/"==o||"\\"==o){d=Le;break}r&&"file"==r.scheme&&!ge(L(m(i,u),""))&&(me(r.path[0],!0)?V(c.path,r.path[0]):c.host=r.host),d=Ue;continue;case Le:if(o==n||"/"==o||"\\"==o||"?"==o||"#"==o){if(!t&&me(l))d=Ue;else if(""==l){if(c.host="",t)return;d=je}else{if(s=c.parseHost(l),s)return s;if("localhost"==c.host&&(c.host=""),t)return;l="",d=je}continue}l+=o;break;case je:if(c.isSpecial()){if(d=Ue,"/"!=o&&"\\"!=o)continue}else if(t||"?"!=o)if(t||"#"!=o){if(o!=n&&(d=Ue,"/"!=o))continue}else c.fragment="",d=Fe;else c.query="",d=Ne;break;case Ue:if(o==n||"/"==o||"\\"==o&&c.isSpecial()||!t&&("?"==o||"#"==o)){if(be(l)?(c.shortenPath(),"/"==o||"\\"==o&&c.isSpecial()||V(c.path,"")):ye(l)?"/"==o||"\\"==o&&c.isSpecial()||V(c.path,""):("file"==c.scheme&&!c.path.length&&me(l)&&(c.host&&(c.host=""),l=M(l,0)+":"),V(c.path,l)),l="","file"==c.scheme&&(o==n||"?"==o||"#"==o))while(c.path.length>1&&""===c.path[0])F(c.path);"?"==o?(c.query="",d=Ne):"#"==o&&(c.fragment="",d=Fe)}else l+=ve(o,pe);break;case Ve:"?"==o?(c.query="",d=Ne):"#"==o?(c.fragment="",d=Fe):o!=n&&(c.path[0]+=ve(o,ue));break;case Ne:t||"#"!=o?o!=n&&("'"==o&&c.isSpecial()?c.query+="%27":c.query+="#"==o?"%23":ve(o,ue)):(c.fragment="",d=Fe);break;case Fe:o!=n&&(c.fragment+=ve(o,le));break}u++}},parseHost:function(e){var t,r,n;if("["==M(e,0)){if("]"!=M(e,e.length-1))return W;if(t=se(z(e,1,-1)),!t)return W;this.host=t}else if(this.isSpecial()){if(e=y(e),O(re,e))return W;if(t=ae(e),null===t)return W;this.host=t}else{if(O(ne,e))return W;for(t="",r=h(e),n=0;n<r.length;n++)t+=ve(r[n],ue);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return f(he,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"==this.scheme&&1==t&&me(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,r=e.username,n=e.password,i=e.host,o=e.port,a=e.path,s=e.query,c=e.fragment,d=t+":";return null!==i?(d+="//",e.includesCredentials()&&(d+=r+(n?":"+n:"")+"@"),d+=de(i),null!==o&&(d+=":"+o)):"file"==t&&(d+="//"),d+=e.cannotBeABaseURL?a[0]:a.length?"/"+L(a,"/"):"",null!==s&&(d+="?"+s),null!==c&&(d+="#"+c),d},setHref:function(e){var t=this.parse(e);if(t)throw E(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new ze(e.path[0]).origin}catch(r){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+de(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(b(e)+":",Se)},getUsername:function(){return this.username},setUsername:function(e){var t=h(b(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<t.length;r++)this.username+=ve(t[r],fe)}},getPassword:function(){return this.password},setPassword:function(e){var t=h(b(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<t.length;r++)this.password+=ve(t[r],fe)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?de(e):de(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,xe)},getHostname:function(){var e=this.host;return null===e?"":de(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,Ie)},getPort:function(){var e=this.port;return null===e?"":b(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(e=b(e),""==e?this.port=null:this.parse(e,_e))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+L(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,je))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){e=b(e),""==e?this.query=null:("?"==M(e,0)&&(e=z(e,1)),this.query="",this.parse(e,Ne)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){e=b(e),""!=e?("#"==M(e,0)&&(e=z(e,1)),this.fragment="",this.parse(e,Fe)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var ze=function(e){var t=p(this,Je),r=C(arguments.length,1)>1?arguments[1]:void 0,n=T(t,new Ze(e,!1,r));o||(t.href=n.serialize(),t.origin=n.getOrigin(),t.protocol=n.getProtocol(),t.username=n.getUsername(),t.password=n.getPassword(),t.host=n.getHost(),t.hostname=n.getHostname(),t.port=n.getPort(),t.pathname=n.getPathname(),t.search=n.getSearch(),t.searchParams=n.getSearchParams(),t.hash=n.getHash())},Je=ze.prototype,Ge=function(e,t){return{get:function(){return R(this)[e]()},set:t&&function(e){return R(this)[t](e)},configurable:!0,enumerable:!0}};if(o&&u(Je,{href:Ge("serialize","setHref"),origin:Ge("getOrigin"),protocol:Ge("getProtocol","setProtocol"),username:Ge("getUsername","setUsername"),password:Ge("getPassword","setPassword"),host:Ge("getHost","setHost"),hostname:Ge("getHostname","setHostname"),port:Ge("getPort","setPort"),pathname:Ge("getPathname","setPathname"),search:Ge("getSearch","setSearch"),searchParams:Ge("getSearchParams"),hash:Ge("getHash","setHash")}),l(Je,"toJSON",(function(){return R(this).serialize()}),{enumerable:!0}),l(Je,"toString",(function(){return R(this).serialize()}),{enumerable:!0}),A){var qe=A.createObjectURL,Be=A.revokeObjectURL;qe&&l(ze,"createObjectURL",c(qe,A)),Be&&l(ze,"revokeObjectURL",c(Be,A))}S(ze,"URL"),i({global:!0,forced:!a,sham:!o},{URL:ze})},285:function(e,t,r){r(8789)},4091:function(e,t,r){"use strict";e=r.nmd(e);var n=r(7964)["default"];r(1539),r(9714),r(1249),r(4916),r(3123),r(3210),r(7327),r(9600),r(8309),r(7941),r(4747),r(7042),r(8862);var i={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};i.localCName=i.generateIdentifier(),i.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},i.splitSections=function(e){var t=e.split("\nm=");return t.map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},i.getDescription=function(e){var t=i.splitSections(e);return t&&t[0]},i.getMediaSections=function(e){var t=i.splitSections(e);return t.shift(),t},i.matchPrefix=function(e,t){return i.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},i.parseCandidate=function(e){var t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");for(var r={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},n=8;n<t.length;n+=2)switch(t[n]){case"raddr":r.relatedAddress=t[n+1];break;case"rport":r.relatedPort=parseInt(t[n+1],10);break;case"tcptype":r.tcpType=t[n+1];break;case"ufrag":r.ufrag=t[n+1],r.usernameFragment=t[n+1];break;default:void 0===r[t[n]]&&(r[t[n]]=t[n+1]);break}return r},i.writeCandidate=function(e){var t=[];t.push(e.foundation);var r=e.component;"rtp"===r?t.push(1):"rtcp"===r?t.push(2):t.push(r),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},i.parseIceOptions=function(e){return e.substr(14).split(" ")},i.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=3===t.length?parseInt(t[2],10):1,r.numChannels=r.channels,r},i.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},i.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},i.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},i.parseFmtp=function(e){for(var t,r={},n=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<n.length;i++)t=n[i].trim().split("="),r[t[0].trim()]=t[1];return r},i.writeFmtp=function(e){var t="",r=e.payloadType;if(void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var n=[];Object.keys(e.parameters).forEach((function(t){void 0!==e.parameters[t]?n.push(t+"="+e.parameters[t]):n.push(t)})),t+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return t},i.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},i.writeRtcpFb=function(e){var t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},i.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},n=e.indexOf(":",t);return n>-1?(r.attribute=e.substr(t+1,n-t-1),r.value=e.substr(n+1)):r.attribute=e.substr(t+1),r},i.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},i.getMid=function(e){var t=i.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},i.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},i.getDtlsParameters=function(e,t){var r=i.matchPrefix(e+t,"a=fingerprint:");return{role:"auto",fingerprints:r.map(i.parseFingerprint)}},i.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),r},i.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},i.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"===n(e.keyParams)?i.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},i.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},i.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},i.getCryptoParameters=function(e,t){var r=i.matchPrefix(e+t,"a=crypto:");return r.map(i.parseCryptoLine)},i.getIceParameters=function(e,t){var r=i.matchPrefix(e+t,"a=ice-ufrag:")[0],n=i.matchPrefix(e+t,"a=ice-pwd:")[0];return r&&n?{usernameFragment:r.substr(12),password:n.substr(10)}:null},i.writeIceParameters=function(e){var t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},i.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=i.splitLines(e),n=r[0].split(" "),o=3;o<n.length;o++){var a=n[o],s=i.matchPrefix(e,"a=rtpmap:"+a+" ")[0];if(s){var c=i.parseRtpMap(s),d=i.matchPrefix(e,"a=fmtp:"+a+" ");switch(c.parameters=d.length?i.parseFmtp(d[0]):{},c.rtcpFeedback=i.matchPrefix(e,"a=rtcp-fb:"+a+" ").map(i.parseRtcpFb),t.codecs.push(c),c.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(c.name.toUpperCase());break;default:break}}}return i.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(i.parseExtmap(e))})),t},i.writeRtpDescription=function(e,t){var r="";r+="m="+e+" ",r+=t.codecs.length>0?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){r+=i.writeRtpMap(e),r+=i.writeFmtp(e),r+=i.writeRtcpFb(e)}));var n=0;return t.codecs.forEach((function(e){e.maxptime>n&&(n=e.maxptime)})),n>0&&(r+="a=maxptime:"+n+"\r\n"),t.headerExtensions&&t.headerExtensions.forEach((function(e){r+=i.writeExtmap(e)})),r},i.parseRtpEncodingParameters=function(e){var t,r=[],n=i.parseRtpParameters(e),o=-1!==n.fecMechanisms.indexOf("RED"),a=-1!==n.fecMechanisms.indexOf("ULPFEC"),s=i.matchPrefix(e,"a=ssrc:").map((function(e){return i.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=s.length>0&&s[0].ssrc,d=i.matchPrefix(e,"a=ssrc-group:FID").map((function(e){var t=e.substr(17).split(" ");return t.map((function(e){return parseInt(e,10)}))}));d.length>0&&d[0].length>1&&d[0][0]===c&&(t=d[0][1]),n.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var n={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(n.rtx={ssrc:t}),r.push(n),o&&(n=JSON.parse(JSON.stringify(n)),n.fec={ssrc:c,mechanism:a?"red+ulpfec":"red"},r.push(n))}})),0===r.length&&c&&r.push({ssrc:c});var u=i.matchPrefix(e,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substr(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substr(5),10)*.95-16e3:void 0,r.forEach((function(e){e.maxBitrate=u}))),r},i.parseRtcpParameters=function(e){var t={},r=i.matchPrefix(e,"a=ssrc:").map((function(e){return i.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];r&&(t.cname=r.value,t.ssrc=r.ssrc);var n=i.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=n.length>0,t.compound=0===n.length;var o=i.matchPrefix(e,"a=rtcp-mux");return t.mux=o.length>0,t},i.writeRtcpParameters=function(e){var t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},i.parseMsid=function(e){var t,r=i.matchPrefix(e,"a=msid:");if(1===r.length)return t=r[0].substr(7).split(" "),{stream:t[0],track:t[1]};var n=i.matchPrefix(e,"a=ssrc:").map((function(e){return i.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return n.length>0?(t=n[0].value.split(" "),{stream:t[0],track:t[1]}):void 0},i.parseSctpDescription=function(e){var t,r=i.parseMLine(e),n=i.matchPrefix(e,"a=max-message-size:");n.length>0&&(t=parseInt(n[0].substr(19),10)),isNaN(t)&&(t=65536);var o=i.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:r.fmt,maxMessageSize:t};var a=i.matchPrefix(e,"a=sctpmap:");if(a.length>0){var s=a[0].substr(10).split(" ");return{port:parseInt(s[0],10),protocol:s[1],maxMessageSize:t}}},i.writeSctpDescription=function(e,t){var r=[];return r="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&r.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),r.join("")},i.generateSessionId=function(){return Math.random().toString().substr(2,21)},i.writeSessionBoilerplate=function(e,t,r){var n,o=void 0!==t?t:2;n=e||i.generateSessionId();var a=r||"thisisadapterortc";return"v=0\r\no="+a+" "+n+" "+o+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},i.getDirection=function(e,t){for(var r=i.splitLines(e),n=0;n<r.length;n++)switch(r[n]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[n].substr(2);default:}return t?i.getDirection(t):"sendrecv"},i.getKind=function(e){var t=i.splitLines(e),r=t[0].split(" ");return r[0].substr(2)},i.isRejected=function(e){return"0"===e.split(" ",2)[1]},i.parseMLine=function(e){var t=i.splitLines(e),r=t[0].substr(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},i.parseOLine=function(e){var t=i.matchPrefix(e,"o=")[0],r=t.substr(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},i.isValidSDP=function(e){if("string"!==typeof e||0===e.length)return!1;for(var t=i.splitLines(e),r=0;r<t.length;r++)if(t[r].length<2||"="!==t[r].charAt(1))return!1;return!0},"object"===n(e)&&(e.exports=i)},7435:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return pe}});var n={};r.r(n),r.d(n,{fixNegotiationNeeded:function(){return M},shimAddTrackRemoveTrack:function(){return I},shimAddTrackRemoveTrackWithNative:function(){return x},shimGetDisplayMedia:function(){return T},shimGetSendersWithDtmf:function(){return D},shimGetStats:function(){return A},shimGetUserMedia:function(){return k},shimMediaStream:function(){return R},shimOnTrack:function(){return P},shimPeerConnection:function(){return _},shimSenderReceiverGetStats:function(){return E}});var i={};r.r(i),r.d(i,{shimAddTransceiver:function(){return z},shimCreateAnswer:function(){return q},shimCreateOffer:function(){return G},shimGetDisplayMedia:function(){return L},shimGetParameters:function(){return J},shimGetUserMedia:function(){return O},shimOnTrack:function(){return j},shimPeerConnection:function(){return U},shimRTCDataChannel:function(){return Z},shimReceiverGetStats:function(){return N},shimRemoveStream:function(){return F},shimSenderGetStats:function(){return V}});var o={};r.r(o),r.d(o,{shimAudioContext:function(){return ee},shimCallbacksAPI:function(){return H},shimConstraints:function(){return $},shimCreateOfferLegacy:function(){return X},shimGetUserMedia:function(){return K},shimLocalStreamsAPI:function(){return B},shimRTCIceServerUrls:function(){return Q},shimRemoteStreamsAPI:function(){return W},shimTrackEventTransceiver:function(){return Y}});var a={};r.r(a),r.d(a,{removeExtmapAllowMixed:function(){return se},shimAddIceCandidateNullOrEmpty:function(){return ce},shimConnectionState:function(){return ae},shimMaxMessageSize:function(){return ie},shimParameterlessSetLocalDescription:function(){return de},shimRTCIceCandidate:function(){return ne},shimSendThrowTypeError:function(){return oe}});var s=r(3796),c=r(9726),d=(r(4916),r(4723),r(1532),r(1539),r(8783),r(3948),r(7941),r(1703),r(4747),r(7852),!0),u=!0;function l(e,t,r){var n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}function p(e,t,r){if(e.RTCPeerConnection){var n=e.RTCPeerConnection.prototype,i=n.addEventListener;n.addEventListener=function(e,n){if(e!==t)return i.apply(this,arguments);var o=function(e){var t=r(e);t&&(n.handleEvent?n.handleEvent(t):n(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(n,o),i.apply(this,[e,o])};var o=n.removeEventListener;n.removeEventListener=function(e,r){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(r))return o.apply(this,arguments);var n=this._eventMap[t].get(r);return this._eventMap[t].delete(r),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,n])},Object.defineProperty(n,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}}function f(e){return"boolean"!==typeof e?new Error("Argument type: "+(0,c.Z)(e)+". Please use a boolean."):(d=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function v(e){return"boolean"!==typeof e?new Error("Argument type: "+(0,c.Z)(e)+". Please use a boolean."):(u=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function h(){if("object"===("undefined"===typeof window?"undefined":(0,c.Z)(window))){if(d)return;"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)}}function m(e,t){u&&console.warn(e+" is deprecated, please use "+t+" instead.")}function g(e){var t={browser:null,version:null};if("undefined"===typeof e||!e.navigator)return t.browser="Not a browser.",t;var r=e.navigator;if(r.mozGetUserMedia)t.browser="firefox",t.version=l(r.userAgent,/Firefox\/(\d+)\./,1);else if(r.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=l(r.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!r.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=l(r.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}function y(e){return"[object Object]"===Object.prototype.toString.call(e)}function b(e){return y(e)?Object.keys(e).reduce((function(t,r){var n=y(e[r]),i=n?b(e[r]):e[r],o=n&&!Object.keys(i).length;return void 0===i||o?t:Object.assign(t,(0,s.Z)({},r,i))}),{}):e}function S(e,t,r){t&&!r.has(t.id)&&(r.set(t.id,t),Object.keys(t).forEach((function(n){n.endsWith("Id")?S(e,e.get(t[n]),r):n.endsWith("Ids")&&t[n].forEach((function(t){S(e,e.get(t),r)}))})))}function C(e,t,r){var n=r?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;var o=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((function(t){e.forEach((function(r){r.type===n&&r.trackId===t.id&&S(e,r,i)}))})),i}r(9826),r(7042),r(561),r(1249),r(7714),r(2801),r(1174),r(7327),r(2222),r(5306),r(4603),r(8450),r(8386),r(9714),r(5003),r(8862),r(6699),r(2023),r(8309);var w=h;function k(e,t){var r=e&&e.navigator;if(r.mediaDevices){var n=function(e){if("object"!==(0,c.Z)(e)||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(r){if("require"!==r&&"advanced"!==r&&"mediaSource"!==r){var n="object"===(0,c.Z)(e[r])?e[r]:{ideal:e[r]};void 0!==n.exact&&"number"===typeof n.exact&&(n.min=n.max=n.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==n.ideal){t.optional=t.optional||[];var o={};"number"===typeof n.ideal?(o[i("min",r)]=n.ideal,t.optional.push(o),o={},o[i("max",r)]=n.ideal,t.optional.push(o)):(o[i("",r)]=n.ideal,t.optional.push(o))}void 0!==n.exact&&"number"!==typeof n.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",r)]=n.exact):["min","max"].forEach((function(e){void 0!==n[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,r)]=n[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},i=function(e,i){if(t.version>=61)return i(e);if(e=JSON.parse(JSON.stringify(e)),e&&"object"===(0,c.Z)(e.audio)){var o=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};e=JSON.parse(JSON.stringify(e)),o(e.audio,"autoGainControl","googAutoGainControl"),o(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=n(e.audio)}if(e&&"object"===(0,c.Z)(e.video)){var a=e.video.facingMode;a=a&&("object"===(0,c.Z)(a)?a:{ideal:a});var s,d=t.version<66;if(a&&("user"===a.exact||"environment"===a.exact||"user"===a.ideal||"environment"===a.ideal)&&(!r.mediaDevices.getSupportedConstraints||!r.mediaDevices.getSupportedConstraints().facingMode||d))if(delete e.video.facingMode,"environment"===a.exact||"environment"===a.ideal?s=["back","rear"]:"user"!==a.exact&&"user"!==a.ideal||(s=["front"]),s)return r.mediaDevices.enumerateDevices().then((function(t){t=t.filter((function(e){return"videoinput"===e.kind}));var r=t.find((function(e){return s.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!r&&t.length&&s.includes("back")&&(r=t[t.length-1]),r&&(e.video.deviceId=a.exact?{exact:r.deviceId}:{ideal:r.deviceId}),e.video=n(e.video),w("chrome: "+JSON.stringify(e)),i(e)}));e.video=n(e.video)}return w("chrome: "+JSON.stringify(e)),i(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},a=function(e,t,n){i(e,(function(e){r.webkitGetUserMedia(e,t,(function(e){n&&n(o(e))}))}))};if(r.getUserMedia=a.bind(r),r.mediaDevices.getUserMedia){var s=r.mediaDevices.getUserMedia.bind(r.mediaDevices);r.mediaDevices.getUserMedia=function(e){return i(e,(function(e){return s(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(o(e))}))}))}}}}function T(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"===typeof t?e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then((function(t){var n=r.video&&r.video.width,i=r.video&&r.video.height,o=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},n&&(r.video.mandatory.maxWidth=n),i&&(r.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(r)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function R(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function P(e){if("object"===(0,c.Z)(e)&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var r=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(n){var i;i=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find((function(e){return e.track&&e.track.id===n.track.id})):{track:n.track};var o=new Event("track");o.track=n.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],r.dispatchEvent(o)})),t.stream.getTracks().forEach((function(n){var i;i=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find((function(e){return e.track&&e.track.id===n.id})):{track:n};var o=new Event("track");o.track=n,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],r.dispatchEvent(o)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else p(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}))}function D(e){if("object"===(0,c.Z)(e)&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){var i=r.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){n.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((function(e){r._senders.push(t(r,e))}))};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach((function(e){var r=t._senders.find((function(t){return t.track===e}));r&&t._senders.splice(t._senders.indexOf(r),1)}))}}else if("object"===(0,c.Z)(e)&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function A(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,r=Array.prototype.slice.call(arguments),n=r[0],i=r[1],o=r[2];if(arguments.length>0&&"function"===typeof n)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!==typeof n))return t.apply(this,[]);var a=function(e){var t={},r=e.result();return r.forEach((function(e){var r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){r[t]=e.stat(t)})),t[r.id]=r})),t},s=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};if(arguments.length>=2){var c=function(e){i(s(a(e)))};return t.apply(this,[c,n])}return new Promise((function(r,n){t.apply(e,[function(e){r(s(a(e)))},n])})).then(i,o)}}}function E(e){if("object"===(0,c.Z)(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return C(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var n=e.RTCPeerConnection.prototype.getReceivers;n&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=n.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),p(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return C(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t,r,n,o=arguments[0];return this.getSenders().forEach((function(e){e.track===o&&(t?n=!0:t=e)})),this.getReceivers().forEach((function(e){return e.track===o&&(r?n=!0:r=e),e.track===o})),n||t&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return i.apply(this,arguments)}}}}function x(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var n=t.apply(this,arguments);return this._shimmedLocalStreams[r.id]?-1===this._shimmedLocalStreams[r.id].indexOf(n)&&this._shimmedLocalStreams[r.id].push(n):this._shimmedLocalStreams[r.id]=[r,n],n};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){var r=t.getSenders().find((function(t){return t.track===e}));if(r)throw new DOMException("Track already exists.","InvalidAccessError")}));var n=this.getSenders();r.apply(this,arguments);var i=this.getSenders().filter((function(e){return-1===n.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(i)};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],n.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(r){var n=t._shimmedLocalStreams[r].indexOf(e);-1!==n&&t._shimmedLocalStreams[r].splice(n,1),1===t._shimmedLocalStreams[r].length&&delete t._shimmedLocalStreams[r]})),i.apply(this,arguments)}}function I(e,t){if(e.RTCPeerConnection){if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return x(e);var r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=r.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var r=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){var t=r.getSenders().find((function(t){return t.track===e}));if(t)throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var i=new e.MediaStream(t.getTracks());this._streams[t.id]=i,this._reverseStreams[i.id]=t,t=i}n.apply(this,[t])};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,r){var n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");var o=this.getSenders().find((function(e){return e.track===t}));if(o)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var a=this._streams[r.id];if(a)a.addTrack(t),Promise.resolve().then((function(){n.dispatchEvent(new Event("negotiationneeded"))}));else{var s=new e.MediaStream([t]);this._streams[r.id]=s,this._reverseStreams[s.id]=r,this.addStream(s)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t],n=(0,s.Z)({},t,(function(){var e=this,t=arguments,n=arguments.length&&"function"===typeof arguments[0];return n?r.apply(this,[function(r){var n=c(e,r);t[0].apply(null,[n])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):r.apply(this,arguments).then((function(t){return c(e,t)}))}));e.RTCPeerConnection.prototype[t]=n[t]}));var o=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=d(this,arguments[0]),o.apply(this,arguments)):o.apply(this,arguments)};var a=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=a.get.apply(this);return""===e.type?e:c(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");var r,n=e._pc===this;if(!n)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach((function(n){var i=t._streams[n].getTracks().find((function(t){return e.track===t}));i&&(r=t._streams[n])})),r&&(1===r.getTracks().length?this.removeStream(this._reverseStreams[r.id]):r.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function c(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(i.id,"g"),n.id)})),new RTCSessionDescription({type:t.type,sdp:r})}function d(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var n=e._reverseStreams[t],i=e._streams[n.id];r=r.replace(new RegExp(n.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:r})}}function _(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t],n=(0,s.Z)({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=n[t]}))}function M(e,t){p(e,"negotiationneeded",(function(e){var r=e.target;if(!(t.version<72||r.getConfiguration&&"plan-b"===r.getConfiguration().sdpSemantics)||"stable"===r.signalingState)return e}))}r(7601);function O(e,t){var r=e&&e.navigator,n=e&&e.MediaStreamTrack;if(r.getUserMedia=function(e,t,n){m("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(e).then(t,n)},!(t.version>55&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){var i=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},o=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(e){return"object"===(0,c.Z)(e)&&"object"===(0,c.Z)(e.audio)&&(e=JSON.parse(JSON.stringify(e)),i(e.audio,"autoGainControl","mozAutoGainControl"),i(e.audio,"noiseSuppression","mozNoiseSuppression")),o(e)},n&&n.prototype.getSettings){var a=n.prototype.getSettings;n.prototype.getSettings=function(){var e=a.apply(this,arguments);return i(e,"mozAutoGainControl","autoGainControl"),i(e,"mozNoiseSuppression","noiseSuppression"),e}}if(n&&n.prototype.applyConstraints){var s=n.prototype.applyConstraints;n.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===(0,c.Z)(e)&&(e=JSON.parse(JSON.stringify(e)),i(e,"autoGainControl","mozAutoGainControl"),i(e,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[e])}}}}function L(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(r){if(!r||!r.video){var n=new DOMException("getDisplayMedia without video constraints is undefined");return n.name="NotFoundError",n.code=8,Promise.reject(n)}return!0===r.video?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)})}function j(e){"object"===(0,c.Z)(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function U(e,t){if("object"===(0,c.Z)(e)&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t],n=(0,s.Z)({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=n[t]}));var r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),i=e[0],o=e[1],a=e[2];return n.apply(this,[i||null]).then((function(e){if(t.version<53&&!o)try{e.forEach((function(e){e.type=r[e.type]||e.type}))}catch(n){if("TypeError"!==n.name)throw n;e.forEach((function(t,n){e.set(n,Object.assign({},t,{type:r[t.type]||t.type}))}))}return e})).then(o,a)}}}function V(e){if("object"===(0,c.Z)(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}}function N(e){if("object"===(0,c.Z)(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r}),p(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}}function F(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;m("removeStream","removeTrack"),this.getSenders().forEach((function(r){r.track&&e.getTracks().includes(r.track)&&t.removeTrack(r)}))})}function Z(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function z(e){if("object"===(0,c.Z)(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],r=e&&"sendEncodings"in e;r&&e.sendEncodings.forEach((function(e){if("rid"in e){var t=/^[a-z0-9]{0,16}$/i;if(!t.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var n=t.apply(this,arguments);if(r){var i=n.sender,o=i.getParameters();(!("encodings"in o)||1===o.encodings.length&&0===Object.keys(o.encodings[0]).length)&&(o.encodings=e.sendEncodings,i.sendEncodings=e.sendEncodings,this.setParametersPromises.push(i.setParameters(o).then((function(){delete i.sendEncodings})).catch((function(){delete i.sendEncodings}))))}return n})}}function J(e){if("object"===(0,c.Z)(e)&&e.RTCRtpSender){var t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){var e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}}function G(e){if("object"===(0,c.Z)(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=arguments,r=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(r,e)})).finally((function(){r.setParametersPromises=[]})):t.apply(this,arguments)}}}function q(e){if("object"===(0,c.Z)(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=arguments,r=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(r,e)})).finally((function(){r.setParametersPromises=[]})):t.apply(this,arguments)}}}function B(e){if("object"===(0,c.Z)(e)&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(n){return t.call(r,n,e)})),e.getVideoTracks().forEach((function(n){return t.call(r,n,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var r=this,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return i&&i.forEach((function(e){r._localStreams?r._localStreams.includes(e)||r._localStreams.push(e):r._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var r=this._localStreams.indexOf(e);if(-1!==r){this._localStreams.splice(r,1);var n=e.getTracks();this.getSenders().forEach((function(e){n.includes(e.track)&&t.removeTrack(e)}))}})}}function W(e){if("object"===(0,c.Z)(e)&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var r=new Event("addstream");r.stream=e,t.dispatchEvent(r)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var r=new Event("addstream");r.stream=t,e.dispatchEvent(r)}}))}),t.apply(e,arguments)}}}function H(e){if("object"===(0,c.Z)(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,r=t.createOffer,n=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i};var s=function(e,t,r){var n=i.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n};t.setLocalDescription=s,s=function(e,t,r){var n=o.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.setRemoteDescription=s,s=function(e,t,r){var n=a.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.addIceCandidate=s}}function K(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var r=t.mediaDevices,n=r.getUserMedia.bind(r);t.mediaDevices.getUserMedia=function(e){return n($(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,r,n){t.mediaDevices.getUserMedia(e).then(r,n)}.bind(t))}function $(e){return e&&void 0!==e.video?Object.assign({},e,{video:b(e.video)}):e}function Q(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,r){if(e&&e.iceServers){for(var n=[],i=0;i<e.iceServers.length;i++){var o=e.iceServers[i];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(m("RTCIceServer.url","RTCIceServer.urls"),o=JSON.parse(JSON.stringify(o)),o.urls=o.url,delete o.url,n.push(o)):n.push(e.iceServers[i])}e.iceServers=n}return new t(e,r)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})}}function Y(e){"object"===(0,c.Z)(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function X(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){"undefined"!==typeof e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var r=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveAudio||r||this.addTransceiver("audio",{direction:"recvonly"}),"undefined"!==typeof e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var n=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function ee(e){"object"!==(0,c.Z)(e)||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}r(3753),r(9653),r(9600),r(3123),r(3210);var te=r(4091),re=r.n(te);function ne(e){if(!(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===(0,c.Z)(e)&&e.candidate&&0===e.candidate.indexOf("a=")&&(e=JSON.parse(JSON.stringify(e)),e.candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var r=new t(e),n=re().parseCandidate(e.candidate),i=Object.assign(r,n);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,p(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}}function ie(e,t){if(e.RTCPeerConnection){"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp}});var r=function(e){if(!e||!e.sdp)return!1;var t=re().splitSections(e.sdp);return t.shift(),t.some((function(e){var t=re().parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))},n=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var r=parseInt(t[1],10);return r!==r?-1:r},i=function(e){var r=65536;return"firefox"===t.browser&&(r=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),r},o=function(e,r){var n=65536;"firefox"===t.browser&&57===t.version&&(n=65535);var i=re().matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?n=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==r&&(n=2147483637),n},a=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){var e=this.getConfiguration(),s=e.sdpSemantics;"plan-b"===s&&Object.defineProperty(this,"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(r(arguments[0])){var c,d=n(arguments[0]),u=i(d),l=o(arguments[0],d);c=0===u&&0===l?Number.POSITIVE_INFINITY:0===u||0===l?Math.max(u,l):Math.min(u,l);var p={};Object.defineProperty(p,"maxMessageSize",{get:function(){return c}}),this._sctp=p}return a.apply(this,arguments)}}}function oe(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return r(e,this),e},p(e,"datachannel",(function(e){return r(e.channel,e.target),e}))}function r(e,t){var r=e.send;e.send=function(){var n=arguments[0],i=n.length||n.size||n.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return r.apply(e,arguments)}}}function ae(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var r=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var r=new Event("connectionstatechange",e);t.dispatchEvent(r)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}}))}}function se(e,t){if(e.RTCPeerConnection&&!("chrome"===t.browser&&t.version>=71)&&!("safari"===t.browser&&t.version>=605)){var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){var n=t.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return r.apply(this,arguments)}}}function ce(e,t){if(e.RTCPeerConnection&&e.RTCPeerConnection.prototype){var r=e.RTCPeerConnection.prototype.addIceCandidate;r&&0!==r.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}}function de(e,t){if(e.RTCPeerConnection&&e.RTCPeerConnection.prototype){var r=e.RTCPeerConnection.prototype.setLocalDescription;r&&0!==r.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){var e=this,t=arguments[0]||{};if("object"!==(0,c.Z)(t)||t.type&&t.sdp)return r.apply(this,arguments);if(t={type:t.type,sdp:t.sdp},!t.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":t.type="offer";break;default:t.type="answer";break}if(t.sdp||"offer"!==t.type&&"answer"!==t.type)return r.apply(this,[t]);var n="offer"===t.type?this.createOffer:this.createAnswer;return n.apply(this).then((function(t){return r.apply(e,[t])}))})}}function ue(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.window,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0},s=h,c=g(t),d={browserDetails:c,commonShim:a,extractVersion:l,disableLog:f,disableWarnings:v,sdp:te};switch(c.browser){case"chrome":if(!n||!_||!r.shimChrome)return s("Chrome shim is not included in this adapter release."),d;if(null===c.version)return s("Chrome shim can not determine version, not shimming."),d;s("adapter.js shimming chrome."),d.browserShim=n,ce(t,c),de(t,c),k(t,c),R(t,c),_(t,c),P(t,c),I(t,c),D(t,c),A(t,c),E(t,c),M(t,c),ne(t,c),ae(t,c),ie(t,c),oe(t,c),se(t,c);break;case"firefox":if(!i||!U||!r.shimFirefox)return s("Firefox shim is not included in this adapter release."),d;s("adapter.js shimming firefox."),d.browserShim=i,ce(t,c),de(t,c),O(t,c),U(t,c),j(t,c),F(t,c),V(t,c),N(t,c),Z(t,c),z(t,c),J(t,c),G(t,c),q(t,c),ne(t,c),ae(t,c),ie(t,c),oe(t,c);break;case"safari":if(!o||!r.shimSafari)return s("Safari shim is not included in this adapter release."),d;s("adapter.js shimming safari."),d.browserShim=o,ce(t,c),de(t,c),Q(t,c),X(t,c),H(t,c),B(t,c),W(t,c),Y(t,c),K(t,c),ee(t,c),ne(t,c),ie(t,c),oe(t,c),se(t,c);break;default:s("Unsupported browser!");break}return d}var le=ue({window:"undefined"===typeof window?void 0:window}),pe=le}}]);
//# sourceMappingURL=about-legacy.7e9f6f8d.js.map